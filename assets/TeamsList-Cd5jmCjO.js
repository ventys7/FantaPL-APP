import{c as _,t as k,u as P,r as g,j as e,L,U as D,d as $,D as T,i as E,p as S,A as q}from"./index-GZhtjL7x.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=_("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]),U=()=>{const{players:t,loading:i,realTeams:a}=k(),{user:u}=P(),[d,m]=g.useState([]),[o,s]=g.useState([]),[h,f]=g.useState(!0);return g.useEffect(()=>{(async()=>{try{const r=await $.listDocuments(T,E);s(r.documents)}catch(r){console.error("Error fetching fantasy teams:",r)}finally{f(!1)}})()},[]),g.useEffect(()=>{if(!t.length||!o.length)return;const r=o.filter(n=>!n.hidden&&n.manager_name!=="Admin").map(n=>{const p=n.manager_name||"N/A",w=n.$id,y=t.filter(x=>x.owner===p),l={P:0,D:0,C:0,A:0},N=new Set;let j=0;y.forEach(x=>{j+=x.purchase_price||0,x.position==="Portiere"?N.add(x.team_id):x.position==="Difensore"?l.D++:x.position==="Centrocampista"?l.C++:x.position==="Attaccante"&&l.A++}),l.P=N.size;const v=l.P+l.D+l.C+l.A,C=l.P===2&&l.D===8&&l.C===8&&l.A===6,A=500-j;return{managerName:p,teamName:n.team_name||`Squadra di ${p}`,logoUrl:n.fantasylogo_url,budget:500,spent:j,remaining:A,players:y,activePlayersCount:y.length,roleCounts:l,isComplete:C,totalPlayers:v,teamId:w}});r.sort((n,p)=>n.managerName.localeCompare(p.managerName)),m(r)},[t,o]),i||h?e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-pl-dark via-[#1a0a1f] to-pl-dark flex items-center justify-center",children:e.jsx(L,{className:"w-12 h-12 animate-spin text-pl-teal"})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-pl-dark via-[#1a0a1f] to-pl-dark pb-20",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8 text-center md:text-left",children:[e.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center justify-center md:justify-start gap-3",children:[e.jsx(D,{className:"text-pl-teal"}),"Lista Rose"]}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Panoramica delle rose, budget residui e completamento squadre."})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:d.map((c,r)=>e.jsx(z,{team:c,realTeams:a},r))})]})})},z=({team:t,realTeams:i})=>{const[a,u]=g.useState("ALL"),d=m=>{u(o=>o===m?"ALL":m)};return e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-2xl overflow-hidden hover:border-white/20 transition group",children:[e.jsxs("div",{className:"p-5 bg-gradient-to-r from-white/5 to-transparent border-b border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-pl-teal/10 border-2 border-pl-teal/20 flex items-center justify-center overflow-hidden shrink-0 shadow-lg",children:t.logoUrl?e.jsx("img",{src:t.logoUrl,alt:t.teamName,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-2xl font-bold text-pl-teal",children:t.managerName.charAt(0)})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-white truncate",title:t.teamName,children:t.teamName}),e.jsxs("div",{className:"text-sm text-gray-400 font-medium",children:["Allenatore: ",e.jsx("span",{className:"text-gray-200",children:t.managerName})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs text-gray-500 font-bold uppercase tracking-wider",children:"Budget"}),e.jsxs("div",{className:"flex items-center gap-1.5 text-pl-teal font-mono font-bold text-lg",children:[e.jsx(F,{size:16}),t.remaining," ",e.jsx("span",{className:"text-xs text-gray-500 font-normal self-end mb-0.5",children:"/ 500"})]})]}),e.jsxs("div",{className:`px-3 py-1 rounded-full text-xs font-bold border flex items-center gap-1.5 ${t.isComplete?"bg-green-500/20 text-green-400 border-green-500/30":"bg-yellow-500/10 text-yellow-400 border-yellow-500/20"}`,children:[t.isComplete?e.jsx(S,{size:12}):e.jsx(q,{size:12}),t.isComplete?"ROSA COMPLETA":"INCOMPLETA"]})]})]}),e.jsxs("div",{className:"p-4 bg-black/20 text-xs text-gray-400 grid grid-cols-4 gap-2 text-center border-b border-white/5",children:[e.jsxs("button",{onClick:()=>d("P"),className:`transition-colors py-1 rounded hover:bg-white/5 ${a==="P"?"bg-white/10 ring-1 ring-white/20":""} ${t.roleCounts.P===2?"text-green-400 font-bold":""}`,children:["P: ",t.roleCounts.P,"/2"]}),e.jsxs("button",{onClick:()=>d("D"),className:`transition-colors py-1 rounded hover:bg-white/5 ${a==="D"?"bg-white/10 ring-1 ring-white/20":""} ${t.roleCounts.D===8?"text-green-400 font-bold":""}`,children:["D: ",t.roleCounts.D,"/8"]}),e.jsxs("button",{onClick:()=>d("C"),className:`transition-colors py-1 rounded hover:bg-white/5 ${a==="C"?"bg-white/10 ring-1 ring-white/20":""} ${t.roleCounts.C===8?"text-green-400 font-bold":""}`,children:["C: ",t.roleCounts.C,"/8"]}),e.jsxs("button",{onClick:()=>d("A"),className:`transition-colors py-1 rounded hover:bg-white/5 ${a==="A"?"bg-white/10 ring-1 ring-white/20":""} ${t.roleCounts.A===6?"text-green-400 font-bold":""}`,children:["A: ",t.roleCounts.A,"/6"]})]}),e.jsxs("div",{className:"max-h-[400px] overflow-y-auto divide-y divide-white/5 bg-black/10 transition-all",children:[(a==="ALL"||a==="P")&&e.jsx(b,{players:t.players,role:"Portiere",label:"Portieri",required:2,countType:"block",realTeams:i}),(a==="ALL"||a==="D")&&e.jsx(b,{players:t.players,role:"Difensore",label:"Difensori",required:8,realTeams:i}),(a==="ALL"||a==="C")&&e.jsx(b,{players:t.players,role:"Centrocampista",label:"Centrocampisti",required:8,realTeams:i}),(a==="ALL"||a==="A")&&e.jsx(b,{players:t.players,role:"Attaccante",label:"Attaccanti",required:6,realTeams:i})]})]})},b=({players:t,role:i,label:a,required:u,countType:d="player",realTeams:m=[]})=>{const o=t.filter(s=>s.position===i);return o.sort((s,h)=>(h.purchase_price||0)-(s.purchase_price||0)),e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 px-1",children:[e.jsx("span",{className:"text-[10px] uppercase font-bold text-gray-500",children:a}),e.jsx("span",{className:`text-[10px] font-mono ${o.length===(d==="block"?99:u)?"text-green-400":"text-gray-600"}`})]}),o.length===0?e.jsx("div",{className:"px-2 py-1 text-xs text-gray-600 italic",children:"-"}):e.jsx("div",{className:"space-y-1",children:o.map(s=>{var h,f;return e.jsxs("div",{className:"flex items-center justify-between px-2 py-2 rounded hover:bg-white/5 transition group",children:[e.jsxs("div",{className:"flex items-center gap-3 overflow-hidden flex-1 min-w-0",children:[e.jsx("div",{className:"w-9 h-9 md:w-12 md:h-12 flex items-center justify-center shrink-0",title:s.team_name,children:e.jsx("img",{src:`https://images.fotmob.com/image_resources/logo/teamlogo/${s.team_id.replace("team_","")}.png`,alt:s.team_short_name,className:"w-full h-full object-contain drop-shadow-md",loading:"lazy",onError:c=>{var n;const r=c.target;r.style.display="none",r.parentElement&&(r.parentElement.innerText=((n=s.team_short_name)==null?void 0:n.substring(0,3))||"?",r.parentElement.className="w-9 h-9 md:w-12 md:h-12 flex items-center justify-center shrink-0 bg-white/10 rounded-md text-[10px] md:text-xs font-bold text-gray-400")}})}),e.jsx("div",{className:"w-9 h-9 md:w-12 md:h-12 rounded-full bg-white/10 overflow-hidden shrink-0 border border-white/20",children:s.image_url?e.jsx("img",{src:s.image_url,alt:s.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-[9px] md:text-xs text-gray-500",children:"?"})}),e.jsx("span",{className:"text-sm md:text-base text-gray-200 truncate group-hover:text-white transition font-medium",children:s.name})]}),e.jsxs("div",{className:"flex items-center gap-3 shrink-0 ml-2",children:[e.jsxs("div",{className:"flex flex-col items-end leading-none",children:[e.jsx("span",{className:"text-[8px] md:text-[10px] text-gray-500 mb-0.5",children:"Q"}),e.jsx("span",{className:"text-xs md:text-base font-medium text-white",children:i==="Portiere"?((h=m.find(c=>c.$id===s.team_id))==null?void 0:h.goalkeeper_quotation)??s.quotation:s.quotation})]}),e.jsxs("div",{className:"flex flex-col items-end leading-none w-8",children:[e.jsx("span",{className:"text-[8px] md:text-[10px] text-gray-500 mb-0.5",children:"Price"}),e.jsx("span",{className:"text-xs md:text-base font-bold text-pl-teal",children:i==="Portiere"?((f=m.find(c=>c.$id===s.team_id))==null?void 0:f.goalkeeper_purchase_price)??s.purchase_price??"-":s.purchase_price||"-"})]})]})]},s.$id)})})]})};export{U as TeamsList};
