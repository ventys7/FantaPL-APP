import{c as A,t as P,u as $,r as p,j as e,L,U as S,d as E,D as T,i as k,p as D,A as q,f as z}from"./index-DLw58pc8.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=A("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]),M=()=>{const{players:a,loading:d,realTeams:i}=P(),{user:j}=$(),[m,f]=p.useState([]),[x,N]=p.useState([]),[w,h]=p.useState(!0);return p.useEffect(()=>{(async()=>{try{const r=await E.listDocuments(T,k);N(r.documents)}catch(r){console.error("Error fetching fantasy teams:",r)}finally{h(!1)}})()},[]),p.useEffect(()=>{if(!a.length||!x.length)return;const r=x.filter(s=>!s.hidden&&s.manager_name!=="Admin").map(s=>{const t=s.manager_name||"N/A",c=s.$id,o=a.filter(g=>g.owner===t),n={P:0,D:0,C:0,A:0},u=new Set;let b=0;o.forEach(g=>{b+=g.purchase_price||0,g.position==="Portiere"?u.add(g.team_id):g.position==="Difensore"?n.D++:g.position==="Centrocampista"?n.C++:g.position==="Attaccante"&&n.A++}),n.P=u.size;const v=n.P+n.D+n.C+n.A,_=n.P===2&&n.D===8&&n.C===8&&n.A===6,C=s.credits??500;return{managerName:t,teamName:s.team_name||`Squadra di ${t}`,logoUrl:s.fantasylogo_url,budget:s.budget||500,spent:b,remaining:C,players:o,activePlayersCount:o.length,roleCounts:n,isComplete:_,totalPlayers:v,teamId:c}});r.sort((s,t)=>{const c=s.managerName.includes("-"),o=t.managerName.includes("-");return c&&!o?1:!c&&o?-1:s.managerName.localeCompare(t.managerName)}),f(r)},[a,x]),d||w?e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-pl-dark via-[#1a0a1f] to-pl-dark flex items-center justify-center",children:e.jsx(L,{className:"w-12 h-12 animate-spin text-pl-teal"})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-pl-dark via-[#1a0a1f] to-pl-dark pb-20",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8 text-center md:text-left",children:[e.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center justify-center md:justify-start gap-3",children:[e.jsx(S,{className:"text-pl-teal"}),"Lista Rose"]}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Panoramica delle rose, budget residui e completamento squadre."})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:m.map((l,r)=>e.jsx(F,{team:l,realTeams:i},r))})]})})},F=({team:a,realTeams:d})=>{const[i,j]=p.useState("ALL"),m=f=>{j(x=>x===f?"ALL":f)};return e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-2xl overflow-hidden hover:border-white/20 transition group",children:[e.jsxs("div",{className:"p-5 bg-gradient-to-r from-white/5 to-transparent border-b border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-pl-teal/10 border-2 border-pl-teal/20 flex items-center justify-center overflow-hidden shrink-0 shadow-lg",children:a.logoUrl?e.jsx("img",{src:a.logoUrl,alt:a.teamName,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-2xl font-bold text-pl-teal",children:a.managerName.charAt(0)})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-white truncate",title:a.teamName,children:a.teamName}),e.jsxs("div",{className:"text-sm text-gray-400 font-medium",children:["Allenatore: ",e.jsx("span",{className:"text-gray-200",children:a.managerName})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs text-gray-500 font-bold uppercase tracking-wider",children:"Budget"}),e.jsxs("div",{className:"flex items-center gap-1.5 text-pl-teal font-mono font-bold text-lg",children:[e.jsx(B,{size:16}),a.remaining," ",e.jsxs("span",{className:"text-xs text-gray-500 font-normal self-end mb-0.5",children:["/ ",a.budget]})]})]}),e.jsxs("div",{className:`px-3 py-1 rounded-full text-xs font-bold border flex items-center gap-1.5 ${a.isComplete?"bg-green-500/20 text-green-400 border-green-500/30":"bg-yellow-500/10 text-yellow-400 border-yellow-500/20"}`,children:[a.isComplete?e.jsx(D,{size:12}):e.jsx(q,{size:12}),a.isComplete?"ROSA COMPLETA":"INCOMPLETA"]})]})]}),e.jsxs("div",{className:"p-4 bg-black/20 text-xs text-gray-400 grid grid-cols-4 gap-2 text-center border-b border-white/5",children:[e.jsxs("button",{onClick:()=>m("P"),className:`transition-colors py-1 rounded hover:bg-white/5 ${i==="P"?"bg-white/10 ring-1 ring-white/20":""} ${a.roleCounts.P===2?"text-green-400 font-bold":""}`,children:["P: ",a.roleCounts.P,"/2"]}),e.jsxs("button",{onClick:()=>m("D"),className:`transition-colors py-1 rounded hover:bg-white/5 ${i==="D"?"bg-white/10 ring-1 ring-white/20":""} ${a.roleCounts.D===8?"text-green-400 font-bold":""}`,children:["D: ",a.roleCounts.D,"/8"]}),e.jsxs("button",{onClick:()=>m("C"),className:`transition-colors py-1 rounded hover:bg-white/5 ${i==="C"?"bg-white/10 ring-1 ring-white/20":""} ${a.roleCounts.C===8?"text-green-400 font-bold":""}`,children:["C: ",a.roleCounts.C,"/8"]}),e.jsxs("button",{onClick:()=>m("A"),className:`transition-colors py-1 rounded hover:bg-white/5 ${i==="A"?"bg-white/10 ring-1 ring-white/20":""} ${a.roleCounts.A===6?"text-green-400 font-bold":""}`,children:["A: ",a.roleCounts.A,"/6"]})]}),e.jsxs("div",{className:"max-h-[400px] overflow-y-auto divide-y divide-white/5 bg-black/10 transition-all",children:[(i==="ALL"||i==="P")&&e.jsx(y,{players:a.players,role:"Portiere",label:"Portieri",required:2,countType:"block",realTeams:d}),(i==="ALL"||i==="D")&&e.jsx(y,{players:a.players,role:"Difensore",label:"Difensori",required:8,realTeams:d}),(i==="ALL"||i==="C")&&e.jsx(y,{players:a.players,role:"Centrocampista",label:"Centrocampisti",required:8,realTeams:d}),(i==="ALL"||i==="A")&&e.jsx(y,{players:a.players,role:"Attaccante",label:"Attaccanti",required:6,realTeams:d})]})]})},y=({players:a,role:d,label:i,required:j,countType:m="player",realTeams:f=[]})=>{const[x,N]=p.useState(new Set),w=l=>{N(r=>{const s=new Set(r);return s.has(l)?s.delete(l):s.add(l),s})},h=a.filter(l=>l.position===d);if(d==="Portiere"){const r=[...new Set(h.map(s=>s.team_id))].map(s=>{var o,n;const t=f.find(u=>u.$id===s),c=h.filter(u=>u.team_id===s);return{teamId:s,teamName:((o=c[0])==null?void 0:o.team_name)||"Team",teamShortName:((n=c[0])==null?void 0:n.team_short_name)||"???",quotation:(t==null?void 0:t.goalkeeper_quotation)||0,purchasePrice:(t==null?void 0:t.goalkeeper_purchase_price)||0,players:c}});return r.sort((s,t)=>t.purchasePrice-s.purchasePrice),e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"flex items-center justify-between mb-2 px-1",children:e.jsxs("span",{className:"text-[10px] uppercase font-bold text-gray-500",children:[i," (Blocchi)"]})}),r.length===0?e.jsx("div",{className:"px-2 py-1 text-xs text-gray-600 italic",children:"-"}):e.jsx("div",{className:"space-y-1",children:r.map(s=>e.jsxs("div",{children:[e.jsxs("div",{onClick:()=>w(s.teamId),className:"flex items-center justify-between px-2 py-2 rounded hover:bg-white/5 transition group cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-2 overflow-hidden flex-1 min-w-0",children:[e.jsx("div",{className:"w-8 h-8 md:w-9 md:h-9 flex items-center justify-center shrink-0",title:s.teamName,children:e.jsx("img",{src:`https://images.fotmob.com/image_resources/logo/teamlogo/${s.teamId.replace("team_","")}.png`,alt:s.teamShortName,className:"w-full h-full object-contain drop-shadow-md",loading:"lazy",onError:t=>{var o;const c=t.target;c.style.display="none",c.parentElement&&(c.parentElement.innerText=((o=s.teamShortName)==null?void 0:o.substring(0,3))||"?",c.parentElement.className="w-8 h-8 md:w-9 md:h-9 flex items-center justify-center shrink-0 bg-white/10 rounded-md text-[9px] font-bold text-gray-400")}})}),e.jsx("div",{className:"w-8 h-8 md:w-9 md:h-9 shrink-0 overflow-hidden rounded-full border border-white/20 bg-slate-800 shadow-lg pl-0",children:e.jsx("div",{className:`grid w-full h-full p-[1px] gap-[1px] ${s.players.length===2?"grid-cols-2":s.players.length>=3?"grid-cols-2 grid-rows-2":"grid-cols-1"}`,children:s.players.length===1?e.jsx("div",{className:"w-full h-full overflow-hidden",children:e.jsx("img",{src:s.players[0].image_url,alt:"",className:"w-full h-full object-cover"})}):s.players.length===2?s.players.map(t=>e.jsx("div",{className:"w-full h-full overflow-hidden",children:e.jsx("img",{src:t.image_url,alt:"",className:"w-full h-full object-cover scale-[1.1]"})},t.$id)):s.players.length===3?s.players.map(t=>e.jsx("div",{className:"w-full h-full overflow-hidden",children:e.jsx("img",{src:t.image_url,alt:"",className:"w-full h-full object-cover scale-[1.2]"})},t.$id)):s.players.slice(0,4).map((t,c)=>e.jsxs("div",{className:"w-full h-full overflow-hidden relative",children:[e.jsx("img",{src:t.image_url,alt:"",className:"w-full h-full object-cover scale-[1.2]"}),c===3&&s.players.length>4&&e.jsxs("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center text-[8px] font-bold text-white",children:["+",s.players.length-3]})]},t.$id))})}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsxs("span",{className:"text-sm md:text-base text-gray-200 truncate group-hover:text-white transition font-medium",children:["Blocco ",s.teamShortName]}),e.jsx(z,{size:14,className:`text-gray-500 transition shrink-0 ${x.has(s.teamId)?"rotate-180":""}`})]})]}),e.jsxs("div",{className:"flex items-center gap-3 shrink-0 ml-2",children:[e.jsxs("div",{className:"flex flex-col items-end leading-none",children:[e.jsx("span",{className:"text-[8px] md:text-[10px] text-gray-500 mb-0.5",children:"Q"}),e.jsx("span",{className:"text-xs md:text-base font-bold text-white",children:s.quotation})]}),e.jsxs("div",{className:"flex flex-col items-end leading-none w-8",children:[e.jsx("span",{className:"text-[8px] md:text-[10px] text-gray-500 mb-0.5",children:"P"}),e.jsx("span",{className:"text-xs md:text-base font-bold text-pl-teal",children:s.purchasePrice||"-"})]})]})]}),x.has(s.teamId)&&e.jsx("div",{className:"ml-6 pl-3 border-l border-white/10 space-y-1 py-1",children:s.players.map(t=>e.jsxs("div",{className:"flex items-center gap-2 py-1 text-xs text-gray-400",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-white/10 overflow-hidden border border-white/20 shrink-0",children:t.image_url?e.jsx("img",{src:t.image_url,alt:t.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-[8px] text-gray-500",children:"?"})}),e.jsxs("span",{className:`truncate ${t.is_active===!1?"italic text-gray-500":""}`,children:[t.name,t.is_active===!1?"*":""]})]},t.$id))})]},s.teamId))})]})}return h.sort((l,r)=>(r.purchase_price||0)-(l.purchase_price||0)),e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 px-1",children:[e.jsx("span",{className:"text-[10px] uppercase font-bold text-gray-500",children:i}),e.jsx("span",{className:`text-[10px] font-mono ${h.length===(m==="block"?99:j)?"text-green-400":"text-gray-600"}`})]}),h.length===0?e.jsx("div",{className:"px-2 py-1 text-xs text-gray-600 italic",children:"-"}):e.jsx("div",{className:"space-y-1",children:h.map(l=>e.jsxs("div",{className:"flex items-center justify-between px-2 py-2 rounded hover:bg-white/5 transition group",children:[e.jsxs("div",{className:"flex items-center gap-2 overflow-hidden flex-1 min-w-0",children:[e.jsx("div",{className:"w-8 h-8 md:w-9 md:h-9 flex items-center justify-center shrink-0",title:l.team_name,children:e.jsx("img",{src:`https://images.fotmob.com/image_resources/logo/teamlogo/${l.team_id.replace("team_","")}.png`,alt:l.team_short_name,className:"w-full h-full object-contain drop-shadow-md",loading:"lazy",onError:r=>{var t;const s=r.target;s.style.display="none",s.parentElement&&(s.parentElement.innerText=((t=l.team_short_name)==null?void 0:t.substring(0,3))||"?",s.parentElement.className="w-8 h-8 md:w-9 md:h-9 flex items-center justify-center shrink-0 bg-white/10 rounded-md text-[9px] font-bold text-gray-400")}})}),e.jsx("div",{className:"w-8 h-8 md:w-9 md:h-9 rounded-full bg-slate-800 border border-white/20 overflow-hidden shrink-0 shadow-lg",children:l.image_url?e.jsx("img",{src:l.image_url,alt:l.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-[8px] text-gray-500",children:"?"})}),e.jsxs("span",{className:`text-sm md:text-base text-gray-200 truncate group-hover:text-white transition font-medium ${l.is_active===!1?"italic !text-gray-500":""}`,children:[l.name,l.is_active===!1?"*":""]})]}),e.jsxs("div",{className:"flex items-center gap-3 shrink-0 ml-2",children:[e.jsxs("div",{className:"flex flex-col items-end leading-none",children:[e.jsx("span",{className:"text-[8px] md:text-[10px] text-gray-500 mb-0.5",children:"Q"}),e.jsx("span",{className:"text-xs md:text-base font-bold text-white",children:l.quotation})]}),e.jsxs("div",{className:"flex flex-col items-end leading-none w-8",children:[e.jsx("span",{className:"text-[8px] md:text-[10px] text-gray-500 mb-0.5",children:"P"}),e.jsx("span",{className:"text-xs md:text-base font-bold text-pl-teal",children:l.purchase_price||"-"})]})]})]},l.$id))})]})};export{M as TeamsList};
