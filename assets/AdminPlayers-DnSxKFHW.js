import{t as O,r,j as e,L as _,b as Q,m as I,o as G,P as Y,X as B,S as U,d as k,D as C,i as X,Q as S,v as H}from"./index-ClM_nN6k.js";const P=["Portiere","Difensore","Centrocampista","Attaccante"],D={Portiere:1,Difensore:2,Centrocampista:3,Attaccante:4},J="695842e1003a3db19fea",V=()=>{const{players:h,loading:z,refresh:L,teams:q}=O(),[u,b]=r.useState([]);r.useEffect(()=>{b(h)},[h]);const[E,M]=r.useState([]),[o,g]=r.useState(null),[$,f]=r.useState(!1),[a,l]=r.useState({}),[d,A]=r.useState(""),[x,T]=r.useState("Tutti"),[m,R]=r.useState("Tutti"),[j,w]=r.useState(!1);r.useEffect(()=>{(async()=>{try{const i=(await k.listDocuments(C,X,[S.limit(100),S.equal("hidden",!1)])).documents.filter(n=>n.user_id!==J).map(n=>({name:n.manager_name,id:n.$id}));M(i)}catch(s){console.error("Error fetching managers:",s)}})()},[]);const N=t=>{g(t),l({position:t.position,quotation:t.quotation||0,purchase_price:t.purchase_price||0,owner:t.owner||""}),f(!0)},p=()=>{f(!1),g(null),l({})},F=async()=>{if(!o)return;w(!0);const t={position:a.position,quotation:parseInt(a.quotation),purchase_price:parseInt(a.purchase_price),owner:a.owner===""?null:a.owner};({...o,...t},b(s=>s.map(i=>i.$id===o.$id?{...i,...t}:i))),p();try{await k.updateDocument(C,H,o.$id,t)}catch(s){console.error("Save error:",s),alert(`Errore salvataggio: ${s.message}`),L()}finally{w(!1)}},c=r.useMemo(()=>u.filter(s=>!(d&&!s.name.toLowerCase().includes(d.toLowerCase())||x!=="Tutti"&&s.team_short_name!==x||m!=="Tutti"&&s.position!==m)).sort((s,i)=>{const n=(D[s.position]||99)-(D[i.position]||99);if(n!==0)return n;const v=(s.team_short_name||"").localeCompare(i.team_short_name||"");if(v!==0)return v;const y=(i.quotation||0)-(s.quotation||0);return y!==0?y:s.name.localeCompare(i.name)}),[u,d,x,m]);return z&&u.length===0?e.jsx("div",{className:"flex justify-center p-10",children:e.jsx(_,{className:"animate-spin text-pl-teal"})}):e.jsxs("div",{className:"p-4 md:p-8 max-w-full mx-auto space-y-8",children:[e.jsxs("div",{className:"flex flex-col items-center text-center gap-2 mb-8",children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-white flex items-center justify-center gap-3",children:[e.jsx(I,{className:"text-pl-teal w-8 h-8"}),"Gestione Listone"]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1 max-w-md mx-auto",children:"Modifica ruoli, quotazioni e proprietari. Le modifiche sono istantanee."}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-2 mt-4 w-full max-w-2xl justify-center",children:[e.jsxs("div",{className:"relative group w-full md:w-auto",children:[e.jsx(G,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 group-hover:text-pl-teal transition-colors w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Cerca...",value:d,onChange:t=>A(t.target.value),className:"h-[42px] bg-black/30 border border-white/10 rounded-xl pl-9 pr-4 text-sm text-white w-full md:w-56 focus:border-pl-teal/50 outline-none transition-all placeholder-gray-600 focus:bg-black/50"})]}),e.jsxs("select",{value:m,onChange:t=>R(t.target.value),className:"h-[42px] bg-black/30 border border-white/10 rounded-xl px-4 text-sm text-gray-300 outline-none hover:bg-black/40 transition cursor-pointer",children:[e.jsx("option",{value:"Tutti",children:"Tutti i Ruoli"}),P.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:x,onChange:t=>T(t.target.value),className:"h-[42px] bg-black/30 border border-white/10 rounded-xl px-4 text-sm text-gray-300 outline-none hover:bg-black/40 transition cursor-pointer",children:[e.jsx("option",{value:"Tutti",children:"Tutte le Squadre"}),q.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsx("div",{className:"hidden md:block bg-[#1e1e24] border border-white/5 rounded-2xl overflow-hidden shadow-2xl max-w-6xl mx-auto",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-base",children:[e.jsx("thead",{className:"bg-black/40 text-gray-400 font-bold uppercase text-sm tracking-wider sticky top-0 backdrop-blur-sm z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"Giocatore"}),e.jsx("th",{className:"px-6 py-4 w-40",children:"Ruolo"}),e.jsx("th",{className:"px-6 py-4 w-32 text-center",children:"Quotazione"}),e.jsx("th",{className:"px-6 py-4 w-32 text-center",children:"Prezzo"}),e.jsx("th",{className:"px-6 py-4 w-56",children:"Proprietario"})]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-10 text-center text-gray-500 italic",children:"Nessun giocatore trovato"})}):c.slice(0,150).map(t=>e.jsxs("tr",{onClick:()=>N(t),className:"hover:bg-white/[0.03] transition-colors cursor-pointer group",children:[e.jsx("td",{className:"px-6 py-3",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-white group-hover:text-pl-teal transition-colors text-base",children:t.name}),e.jsx("span",{className:"text-xs text-gray-500 uppercase tracking-wide font-medium",children:t.team_short_name})]})})}),e.jsx("td",{className:"px-6 py-3",children:e.jsx("span",{className:`px-2.5 py-1 rounded-md text-xs uppercase font-bold tracking-widest border border-current opacity-80
                                                ${t.position==="Portiere"?"text-yellow-500 border-yellow-500/20 bg-yellow-500/10":t.position==="Difensore"?"text-blue-500 border-blue-500/20 bg-blue-500/10":t.position==="Centrocampista"?"text-green-500 border-green-500/20 bg-green-500/10":"text-red-500 border-red-500/20 bg-red-500/10"}`,children:t.position})}),e.jsx("td",{className:"px-6 py-3 text-center",children:e.jsx("span",{className:"text-gray-300 font-mono text-base",children:t.quotation})}),e.jsx("td",{className:"px-6 py-3 text-center",children:e.jsx("span",{className:`font-mono text-base ${t.purchase_price>0?"text-pl-teal font-bold":"text-gray-600"}`,children:t.purchase_price||"-"})}),e.jsx("td",{className:"px-6 py-3",children:t.owner?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-pl-teal shadow-[0_0_8px_rgba(56,189,248,0.5)]"}),e.jsx("span",{className:"text-sm text-white font-medium",children:t.owner})]}):e.jsx("span",{className:"text-sm text-gray-600 italic",children:"Svincolato"})})]},t.$id))})]})})})]}),e.jsxs("div",{className:"md:hidden space-y-3 pb-20",children:[c.length===0?e.jsx("div",{className:"text-center text-gray-500 py-10 bg-white/5 rounded-xl border border-white/5",children:"Nessun risultato"}):c.slice(0,50).map(t=>e.jsxs("div",{onClick:()=>N(t),className:"bg-[#1e1e24] border border-white/5 rounded-xl p-4 active:scale-[0.98] transition-all cursor-pointer shadow-lg relative overflow-hidden",children:[e.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1 ${t.position==="Portiere"?"bg-yellow-500":t.position==="Difensore"?"bg-blue-500":t.position==="Centrocampista"?"bg-green-500":"bg-red-500"}`}),e.jsxs("div",{className:"flex justify-between items-start pl-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-bold text-base flex items-center gap-2",children:t.name}),e.jsx("div",{className:"text-[11px] text-gray-400 font-medium uppercase tracking-wide mt-0.5 mb-1",children:t.team_short_name}),e.jsx("div",{className:"flex items-center gap-2 mt-1"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider",children:"Prezzo"}),e.jsx("div",{className:`font-mono font-bold ${t.purchase_price>0?"text-pl-teal":"text-gray-600"}`,children:t.purchase_price||"-"})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/5 flex items-center justify-between pl-3",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold",children:"Quotazione"}),e.jsx("span",{className:"text-sm text-white font-mono",children:t.quotation})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold",children:"Proprietario"}),t.owner?e.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-pl-teal shadow-[0_0_6px_rgba(56,189,248,0.5)]"}),e.jsx("span",{className:"text-xs text-white font-medium",children:t.owner})]}):e.jsx("span",{className:"text-xs text-gray-600 italic mt-0.5",children:"Svincolato"})]})]})]},t.$id)),c.length>50&&e.jsx("div",{className:"py-3 text-center text-xs text-gray-600",children:"Mostrati primi 50. Usa i filtri."})]}),$&&o&&Q.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[99999] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/80 transition-opacity animate-in fade-in duration-200",onClick:p}),e.jsxs("div",{className:"relative w-full max-w-lg mx-4 bg-[#18181b] rounded-2xl border border-white/10 shadow-[0_20px_60px_-15px_rgba(0,0,0,0.5)] overflow-hidden animate-in zoom-in-95 fade-in duration-200",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-pl-teal/50 to-transparent"}),e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/5",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(Y,{size:18,className:"text-pl-teal"}),"Modifica Giocatore"]}),e.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:[o.name," (",o.team_short_name,")"]})]}),e.jsx("button",{onClick:p,className:"text-gray-500 hover:text-white transition p-2 hover:bg-white/10 rounded-lg",children:e.jsx(B,{size:20})})]}),e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs uppercase font-bold text-gray-500 tracking-wider",children:"Ruolo Fanta"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:P.map(t=>e.jsx("button",{onClick:()=>l({...a,position:t}),className:`py-2 px-1 rounded-lg text-[10px] font-bold uppercase transition border ${a.position===t?t==="Portiere"?"bg-yellow-500 text-black border-yellow-500":t==="Difensore"?"bg-blue-500 text-white border-blue-500":t==="Centrocampista"?"bg-green-500 text-white border-green-500":"bg-red-500 text-white border-red-500":"bg-white/5 text-gray-400 border-transparent hover:bg-white/10"}`,children:t},t))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs uppercase font-bold text-gray-500 tracking-wider",children:"Quotazione"}),e.jsx("input",{type:"number",value:a.quotation,onChange:t=>l({...a,quotation:t.target.value}),className:"w-full bg-black/30 border border-white/10 rounded-xl px-4 py-3 text-white focus:border-pl-teal outline-none transition font-mono"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs uppercase font-bold text-gray-500 tracking-wider",children:"Prezzo Acquisto"}),e.jsx("input",{type:"number",value:a.purchase_price,onChange:t=>l({...a,purchase_price:t.target.value}),className:"w-full bg-black/30 border border-white/10 rounded-xl px-4 py-3 text-white focus:border-pl-teal outline-none transition font-mono"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs uppercase font-bold text-gray-500 tracking-wider",children:"Proprietario"}),e.jsxs("select",{value:a.owner,onChange:t=>l({...a,owner:t.target.value}),className:"w-full bg-black/30 border border-white/10 rounded-xl px-4 py-3 text-white focus:border-pl-teal outline-none transition",children:[e.jsx("option",{value:"",children:"-- Svincolato --"}),E.map(t=>e.jsx("option",{value:t.name,children:t.name},t.id))]})]})]}),e.jsxs("div",{className:"p-6 border-t border-white/5 flex justify-end gap-3 bg-black/20 rounded-b-2xl",children:[e.jsx("button",{onClick:p,className:"px-5 py-2.5 rounded-xl text-sm font-medium text-gray-400 hover:text-white hover:bg-white/5 transition",children:"Annulla"}),e.jsxs("button",{onClick:F,disabled:j,className:"px-6 py-2.5 rounded-xl text-sm font-bold text-pl-dark bg-pl-teal hover:bg-pl-teal/90 transition shadow-lg shadow-pl-teal/20 flex items-center gap-2",children:[j?e.jsx(_,{size:16,className:"animate-spin"}):e.jsx(U,{size:16}),"Salva Modifiche"]})]})]})]}),document.body)]})};export{V as AdminPlayers};
