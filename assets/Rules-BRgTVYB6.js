import{c as W,r as a,d as ct,D as dt,C as Bt,l as ut,a as Ln,Q as Pn,u as wt,j as d,R as Y,b as Le,B as $n,S as Bn,X as Un,e as Fn}from"./index-nYsONU7C.js";import{P as rn}from"./plus-Bg_ixefD.js";import{M as Hn}from"./minus-BBwJorrc.js";import{T as Xn}from"./trash-2-CcieC1LC.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=W("AlignCenter",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"17",x2:"7",y1:"12",y2:"12",key:"rsh8ii"}],["line",{x1:"19",x2:"5",y1:"18",y2:"18",key:"1t0tuv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=W("AlignJustify",[["line",{x1:"3",x2:"21",y1:"6",y2:"6",key:"4m8b97"}],["line",{x1:"3",x2:"21",y1:"12",y2:"12",key:"10d38w"}],["line",{x1:"3",x2:"21",y1:"18",y2:"18",key:"kwyyxn"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=W("AlignLeft",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}],["line",{x1:"17",x2:"3",y1:"18",y2:"18",key:"1awlsn"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=W("AlignRight",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}],["line",{x1:"21",x2:"7",y1:"18",y2:"18",key:"1g9eri"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=W("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qn=W("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kn=W("BookText",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}],["path",{d:"M8 7h6",key:"1f0q6e"}],["path",{d:"M8 11h8",key:"vwpz6n"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=W("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=W("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=W("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=W("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=W("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=W("Underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=W("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5v0a5.5 5.5 0 0 1-5.5 5.5H11",key:"llx8ln"}]]),rr=[{id:2,title:"2. Ruoli Lega",key:"ruoliLega",content:""},{id:3,title:"3. Modalità Asta, Composizione Rosa, Bonus & Malus",key:"astaRosa",content:""},{id:4,title:"4. Formazione della Squadra",key:"formazione",content:""},{id:5,title:"5. Svolgimento Giornata Campionato",key:"giornata",content:""},{id:6,title:"6. Campionato con Girone e Playoff",key:"campionato",content:""},{id:7,title:"7. Coppa (Coppa Italia e Supercoppa)",key:"coppa",content:""},{id:8,title:"8. Champions/Europa League",key:"champions",content:""},{id:9,title:"9. Mercato e Scambi",key:"mercato",content:""},{id:10,title:"10. Premi",key:"premi",content:""},{id:11,title:"11. Clausole e Punizioni",key:"clausole",content:""},{id:12,title:"12. Conclusione",key:"conclusione",content:""},{id:13,title:"13. Link Utili",key:"link",content:""}],Ft={title:"1. Cenni Principali e Avvertenze",mainText:'Il "PianginaCUP" è a titolo gratuito.',partecipanti:`Partecipanti:
1. Manager 1
2. Manager 2`};function or(){const[e,t]=a.useState(!0),[n,r]=a.useState(!1),[o,i]=a.useState(Ft),[l,s]=a.useState(rr),[c,u]=a.useState([]),[h,f]=a.useState([]),[p,g]=a.useState(null),N=async()=>{try{const v=await ct.listDocuments(dt,Bt);if(v.documents.length>0){const b=v.documents[0];if(g(b.$id),b.cenni_main_text&&i({mainText:b.cenni_main_text,partecipanti:b.cenni_partecipanti||Ft.partecipanti}),b.sections_json)try{const S=JSON.parse(b.sections_json);Array.isArray(S)?s(S):S.sections&&(s(S.sections),S.mainTitle&&i(I=>({...I,title:S.mainTitle})))}catch(S){ut.error("Error parsing sections:",S)}}}catch(v){ut.error("Error loading rules:",v)}finally{t(!1)}},m=async()=>{try{const v=await ct.listDocuments(dt,Ln,[Pn.orderDesc("archived_at")]);u(v.documents)}catch{u([])}},C=async()=>{if(!p)return!1;r(!0);try{const v={mainTitle:o.title,sections:l};return await ct.updateDocument(dt,Bt,p,{cenni_main_text:o.mainText,cenni_partecipanti:o.partecipanti,sections_json:JSON.stringify(v)}),!0}catch(v){return ut.error("Error saving rules:",v),!1}finally{r(!1)}},y=(v,b,S)=>{s(I=>I.map(A=>A.id===v?{...A,[b]:S}:A))},R=()=>{const v=Math.max(...l.map(b=>b.id))+1;s(b=>[...b,{id:v,title:`${v}. Nuova Sezione`,key:`section${v}`,content:""}])},w=v=>{confirm("Sei sicuro di voler eliminare questa sezione?")&&s(b=>b.filter(S=>S.id!==v))},k=(v,b)=>{f(S=>[...S,{field:v,value:b}])},T=()=>{if(h.length===0)return;const v=h[h.length-1];if(f(b=>b.slice(0,-1)),v.field==="mainText")i(b=>({...b,mainText:v.value}));else if(v.field==="partecipanti")i(b=>({...b,partecipanti:v.value}));else if(v.field.startsWith("section-")){const b=parseInt(v.field.replace("section-",""));s(S=>S.map(I=>I.id===b?{...I,content:v.value}:I))}},E=()=>{f([])};return a.useEffect(()=>{N(),m()},[]),{loading:e,saving:n,cenniPrincipali:o,sections:l,archivedRules:c,undoHistory:h,setCenniPrincipali:i,setSections:s,loadRules:N,saveRules:C,updateSection:y,addSection:R,removeSection:w,addToUndoHistory:k,undo:T,clearUndoHistory:E}}const ir=(e,t)=>t?e.replace(/<blur>(.*?)<\/blur>/gi,(n,r)=>"█".repeat(r.length)):e;function sr({children:e}){const{user:t}=wt(),r=ir(e,!t);return d.jsx("span",{dangerouslySetInnerHTML:{__html:r.replace(/\n/g,"<br/>")}})}function Ht({value:e,onChange:t,editMode:n,multiline:r=!1,className:o="",textareaRef:i,dataField:l}){const{hasRole:s}=wt();return n&&s("admin")?r?d.jsx("textarea",{ref:i,"data-field":l,value:e,onChange:c=>t(c.target.value),className:`w-full bg-[#0a0a0f]/80 border border-white/10 focus:border-pl-pink/50 rounded-xl p-5 text-gray-200 focus:outline-none focus:ring-2 focus:ring-pl-pink/20 resize-y min-h-[250px] font-mono text-sm leading-relaxed placeholder:text-gray-600 transition-all ${o}`,placeholder:"Inserisci il contenuto qui..."}):d.jsx("input",{type:"text",value:e,onChange:c=>t(c.target.value),className:`w-full bg-[#0a0a0f]/80 border border-white/10 focus:border-pl-pink/50 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-pl-pink/20 transition-all ${o}`}):d.jsx("div",{className:`leading-relaxed ${o}`,children:d.jsx(sr,{children:e})})}function ar(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.useMemo(()=>r=>{t.forEach(o=>o(r))},t)}const nt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function je(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Ct(e){return"nodeType"in e}function G(e){var t,n;return e?je(e)?e:Ct(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function St(e){const{Document:t}=G(e);return e instanceof t}function _e(e){return je(e)?!1:e instanceof G(e).HTMLElement}function on(e){return e instanceof G(e).SVGElement}function Me(e){return e?je(e)?e.document:Ct(e)?St(e)?e:_e(e)||on(e)?e.ownerDocument:document:document:document}const de=nt?a.useLayoutEffect:a.useEffect;function Dt(e){const t=a.useRef(e);return de(()=>{t.current=e}),a.useCallback(function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.current==null?void 0:t.current(...r)},[])}function lr(){const e=a.useRef(null),t=a.useCallback((r,o)=>{e.current=setInterval(r,o)},[]),n=a.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Ue(e,t){t===void 0&&(t=[e]);const n=a.useRef(e);return de(()=>{n.current!==e&&(n.current=e)},t),n}function Ve(e,t){const n=a.useRef();return a.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function Qe(e){const t=Dt(e),n=a.useRef(null),r=a.useCallback(o=>{o!==n.current&&(t==null||t(o,n.current)),n.current=o},[]);return[n,r]}function vt(e){const t=a.useRef();return a.useEffect(()=>{t.current=e},[e]),t.current}let ft={};function Ye(e,t){return a.useMemo(()=>{if(t)return t;const n=ft[e]==null?0:ft[e]+1;return ft[e]=n,e+"-"+n},[e,t])}function sn(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((i,l)=>{const s=Object.entries(l);for(const[c,u]of s){const h=i[c];h!=null&&(i[c]=h+e*u)}return i},{...t})}}const Ee=sn(1),Fe=sn(-1);function cr(e){return"clientX"in e&&"clientY"in e}function Rt(e){if(!e)return!1;const{KeyboardEvent:t}=G(e.target);return t&&e instanceof t}function dr(e){if(!e)return!1;const{TouchEvent:t}=G(e.target);return t&&e instanceof t}function bt(e){if(dr(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return cr(e)?{x:e.clientX,y:e.clientY}:null}const He=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[He.Translate.toString(e),He.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),Xt="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function ur(e){return e.matches(Xt)?e:e.querySelector(Xt)}const fr={display:"none"};function hr(e){let{id:t,value:n}=e;return Y.createElement("div",{id:t,style:fr},n)}function gr(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Y.createElement("div",{id:t,style:o,role:"status","aria-live":r,"aria-atomic":!0},n)}function pr(){const[e,t]=a.useState("");return{announce:a.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const an=a.createContext(null);function vr(e){const t=a.useContext(an);a.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function br(){const[e]=a.useState(()=>new Set),t=a.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[a.useCallback(r=>{let{type:o,event:i}=r;e.forEach(l=>{var s;return(s=l[o])==null?void 0:s.call(l,i)})},[e]),t]}const xr={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},mr={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function yr(e){let{announcements:t=mr,container:n,hiddenTextDescribedById:r,screenReaderInstructions:o=xr}=e;const{announce:i,announcement:l}=pr(),s=Ye("DndLiveRegion"),[c,u]=a.useState(!1);if(a.useEffect(()=>{u(!0)},[]),vr(a.useMemo(()=>({onDragStart(f){let{active:p}=f;i(t.onDragStart({active:p}))},onDragMove(f){let{active:p,over:g}=f;t.onDragMove&&i(t.onDragMove({active:p,over:g}))},onDragOver(f){let{active:p,over:g}=f;i(t.onDragOver({active:p,over:g}))},onDragEnd(f){let{active:p,over:g}=f;i(t.onDragEnd({active:p,over:g}))},onDragCancel(f){let{active:p,over:g}=f;i(t.onDragCancel({active:p,over:g}))}}),[i,t])),!c)return null;const h=Y.createElement(Y.Fragment,null,Y.createElement(hr,{id:r,value:o.draggable}),Y.createElement(gr,{id:s,announcement:l}));return n?Le.createPortal(h,n):h}var P;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(P||(P={}));function Ze(){}function _t(e,t){return a.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function wr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const se=Object.freeze({x:0,y:0});function ln(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function cn(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function Cr(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function Vt(e){let{left:t,top:n,height:r,width:o}=e;return[{x:t,y:n},{x:t+o,y:n},{x:t,y:n+r},{x:t+o,y:n+r}]}function dn(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Yt(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const Sr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=Yt(t,t.left,t.top),i=[];for(const l of r){const{id:s}=l,c=n.get(s);if(c){const u=ln(Yt(c),o);i.push({id:s,data:{droppableContainer:l,value:u}})}}return i.sort(cn)},Dr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=Vt(t),i=[];for(const l of r){const{id:s}=l,c=n.get(s);if(c){const u=Vt(c),h=o.reduce((p,g,N)=>p+ln(u[N],g),0),f=Number((h/4).toFixed(4));i.push({id:s,data:{droppableContainer:l,value:f}})}}return i.sort(cn)};function Rr(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),l=o-r,s=i-n;if(r<o&&n<i){const c=t.width*t.height,u=e.width*e.height,h=l*s,f=h/(c+u-h);return Number(f.toFixed(4))}return 0}const kr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=[];for(const i of r){const{id:l}=i,s=n.get(l);if(s){const c=Rr(s,t);c>0&&o.push({id:l,data:{droppableContainer:i,value:c}})}}return o.sort(Cr)};function Nr(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function un(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:se}function Er(e){return function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return o.reduce((l,s)=>({...l,top:l.top+e*s.y,bottom:l.bottom+e*s.y,left:l.left+e*s.x,right:l.right+e*s.x}),{...n})}}const jr=Er(1);function Mr(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Tr(e,t,n){const r=Mr(t);if(!r)return e;const{scaleX:o,scaleY:i,x:l,y:s}=r,c=e.left-l-(1-o)*parseFloat(n),u=e.top-s-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),h=o?e.width/o:e.width,f=i?e.height/i:e.height;return{width:h,height:f,top:u,right:c+h,bottom:u+f,left:c}}const Ar={ignoreTransform:!1};function Te(e,t){t===void 0&&(t=Ar);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:h}=G(e).getComputedStyle(e);u&&(n=Tr(n,u,h))}const{top:r,left:o,width:i,height:l,bottom:s,right:c}=n;return{top:r,left:o,width:i,height:l,bottom:s,right:c}}function Wt(e){return Te(e,{ignoreTransform:!0})}function Ir(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Or(e,t){return t===void 0&&(t=G(e).getComputedStyle(e)),t.position==="fixed"}function zr(e,t){t===void 0&&(t=G(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const i=t[o];return typeof i=="string"?n.test(i):!1})}function rt(e,t){const n=[];function r(o){if(t!=null&&n.length>=t||!o)return n;if(St(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!_e(o)||on(o)||n.includes(o))return n;const i=G(e).getComputedStyle(o);return o!==e&&zr(o,i)&&n.push(o),Or(o,i)?n:r(o.parentNode)}return e?r(e):n}function fn(e){const[t]=rt(e,1);return t??null}function ht(e){return!nt||!e?null:je(e)?e:Ct(e)?St(e)||e===Me(e).scrollingElement?window:_e(e)?e:null:null}function hn(e){return je(e)?e.scrollX:e.scrollLeft}function gn(e){return je(e)?e.scrollY:e.scrollTop}function xt(e){return{x:hn(e),y:gn(e)}}var $;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})($||($={}));function pn(e){return!nt||!e?!1:e===document.scrollingElement}function vn(e){const t={x:0,y:0},n=pn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},o=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,l=e.scrollTop>=r.y,s=e.scrollLeft>=r.x;return{isTop:o,isLeft:i,isBottom:l,isRight:s,maxScroll:r,minScroll:t}}const Lr={x:.2,y:.2};function Pr(e,t,n,r,o){let{top:i,left:l,right:s,bottom:c}=n;r===void 0&&(r=10),o===void 0&&(o=Lr);const{isTop:u,isBottom:h,isLeft:f,isRight:p}=vn(e),g={x:0,y:0},N={x:0,y:0},m={height:t.height*o.y,width:t.width*o.x};return!u&&i<=t.top+m.height?(g.y=$.Backward,N.y=r*Math.abs((t.top+m.height-i)/m.height)):!h&&c>=t.bottom-m.height&&(g.y=$.Forward,N.y=r*Math.abs((t.bottom-m.height-c)/m.height)),!p&&s>=t.right-m.width?(g.x=$.Forward,N.x=r*Math.abs((t.right-m.width-s)/m.width)):!f&&l<=t.left+m.width&&(g.x=$.Backward,N.x=r*Math.abs((t.left+m.width-l)/m.width)),{direction:g,speed:N}}function $r(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:l}=window;return{top:0,left:0,right:i,bottom:l,width:i,height:l}}const{top:t,left:n,right:r,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:o,width:e.clientWidth,height:e.clientHeight}}function bn(e){return e.reduce((t,n)=>Ee(t,xt(n)),se)}function Br(e){return e.reduce((t,n)=>t+hn(n),0)}function Ur(e){return e.reduce((t,n)=>t+gn(n),0)}function Fr(e,t){if(t===void 0&&(t=Te),!e)return;const{top:n,left:r,bottom:o,right:i}=t(e);fn(e)&&(o<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Hr=[["x",["left","right"],Br],["y",["top","bottom"],Ur]];class kt{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=rt(n),o=bn(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,l,s]of Hr)for(const c of l)Object.defineProperty(this,c,{get:()=>{const u=s(r),h=o[i]-u;return this.rect[c]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Pe{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var o;(o=this.target)==null||o.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function Xr(e){const{EventTarget:t}=G(e);return e instanceof t?e:Me(e)}function gt(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var ne;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ne||(ne={}));function Gt(e){e.preventDefault()}function _r(e){e.stopPropagation()}var M;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(M||(M={}));const xn={start:[M.Space,M.Enter],cancel:[M.Esc],end:[M.Space,M.Enter,M.Tab]},Vr=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case M.Right:return{...n,x:n.x+25};case M.Left:return{...n,x:n.x-25};case M.Down:return{...n,y:n.y+25};case M.Up:return{...n,y:n.y-25}}};class Nt{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Pe(Me(n)),this.windowListeners=new Pe(G(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ne.Resize,this.handleCancel),this.windowListeners.add(ne.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ne.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&Fr(r),n(se)}handleKeyDown(t){if(Rt(t)){const{active:n,context:r,options:o}=this.props,{keyboardCodes:i=xn,coordinateGetter:l=Vr,scrollBehavior:s="smooth"}=o,{code:c}=t;if(i.end.includes(c)){this.handleEnd(t);return}if(i.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:u}=r.current,h=u?{x:u.left,y:u.top}:se;this.referenceCoordinates||(this.referenceCoordinates=h);const f=l(t,{active:n,context:r.current,currentCoordinates:h});if(f){const p=Fe(f,h),g={x:0,y:0},{scrollableAncestors:N}=r.current;for(const m of N){const C=t.code,{isTop:y,isRight:R,isLeft:w,isBottom:k,maxScroll:T,minScroll:E}=vn(m),v=$r(m),b={x:Math.min(C===M.Right?v.right-v.width/2:v.right,Math.max(C===M.Right?v.left:v.left+v.width/2,f.x)),y:Math.min(C===M.Down?v.bottom-v.height/2:v.bottom,Math.max(C===M.Down?v.top:v.top+v.height/2,f.y))},S=C===M.Right&&!R||C===M.Left&&!w,I=C===M.Down&&!k||C===M.Up&&!y;if(S&&b.x!==f.x){const A=m.scrollLeft+p.x,_=C===M.Right&&A<=T.x||C===M.Left&&A>=E.x;if(_&&!p.y){m.scrollTo({left:A,behavior:s});return}_?g.x=m.scrollLeft-A:g.x=C===M.Right?m.scrollLeft-T.x:m.scrollLeft-E.x,g.x&&m.scrollBy({left:-g.x,behavior:s});break}else if(I&&b.y!==f.y){const A=m.scrollTop+p.y,_=C===M.Down&&A<=T.y||C===M.Up&&A>=E.y;if(_&&!p.x){m.scrollTo({top:A,behavior:s});return}_?g.y=m.scrollTop-A:g.y=C===M.Down?m.scrollTop-T.y:m.scrollTop-E.y,g.y&&m.scrollBy({top:-g.y,behavior:s});break}}this.handleMove(t,Ee(Fe(f,this.referenceCoordinates),g))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Nt.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=xn,onActivation:o}=t,{active:i}=n;const{code:l}=e.nativeEvent;if(r.start.includes(l)){const s=i.activatorNode.current;return s&&e.target!==s?!1:(e.preventDefault(),o==null||o({event:e.nativeEvent}),!0)}return!1}}];function qt(e){return!!(e&&"distance"in e)}function Kt(e){return!!(e&&"delay"in e)}class Et{constructor(t,n,r){var o;r===void 0&&(r=Xr(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:l}=i;this.props=t,this.events=n,this.document=Me(l),this.documentListeners=new Pe(this.document),this.listeners=new Pe(r),this.windowListeners=new Pe(G(l)),this.initialCoordinates=(o=bt(i))!=null?o:se,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(ne.Resize,this.handleCancel),this.windowListeners.add(ne.DragStart,Gt),this.windowListeners.add(ne.VisibilityChange,this.handleCancel),this.windowListeners.add(ne.ContextMenu,Gt),this.documentListeners.add(ne.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Kt(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(qt(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:o}=this.props;o(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(ne.Click,_r,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ne.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:o,props:i}=this,{onMove:l,options:{activationConstraint:s}}=i;if(!o)return;const c=(n=bt(t))!=null?n:se,u=Fe(o,c);if(!r&&s){if(qt(s)){if(s.tolerance!=null&&gt(u,s.tolerance))return this.handleCancel();if(gt(u,s.distance))return this.handleStart()}if(Kt(s)&&gt(u,s.tolerance))return this.handleCancel();this.handlePending(s,u);return}t.cancelable&&t.preventDefault(),l(c)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===M.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Yr={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class jt extends Et{constructor(t){const{event:n}=t,r=Me(n.target);super(t,Yr,r)}}jt.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const Wr={move:{name:"mousemove"},end:{name:"mouseup"}};var mt;(function(e){e[e.RightClick=2]="RightClick"})(mt||(mt={}));class Gr extends Et{constructor(t){super(t,Wr,Me(t.event.target))}}Gr.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===mt.RightClick?!1:(r==null||r({event:n}),!0)}}];const pt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class qr extends Et{constructor(t){super(t,pt)}static setup(){return window.addEventListener(pt.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(pt.move.name,t)};function t(){}}}qr.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:o}=n;return o.length>1?!1:(r==null||r({event:n}),!0)}}];var $e;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})($e||($e={}));var et;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(et||(et={}));function Kr(e){let{acceleration:t,activator:n=$e.Pointer,canScroll:r,draggingRect:o,enabled:i,interval:l=5,order:s=et.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:h,delta:f,threshold:p}=e;const g=Qr({delta:f,disabled:!i}),[N,m]=lr(),C=a.useRef({x:0,y:0}),y=a.useRef({x:0,y:0}),R=a.useMemo(()=>{switch(n){case $e.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case $e.DraggableRect:return o}},[n,o,c]),w=a.useRef(null),k=a.useCallback(()=>{const E=w.current;if(!E)return;const v=C.current.x*y.current.x,b=C.current.y*y.current.y;E.scrollBy(v,b)},[]),T=a.useMemo(()=>s===et.TreeOrder?[...u].reverse():u,[s,u]);a.useEffect(()=>{if(!i||!u.length||!R){m();return}for(const E of T){if((r==null?void 0:r(E))===!1)continue;const v=u.indexOf(E),b=h[v];if(!b)continue;const{direction:S,speed:I}=Pr(E,b,R,t,p);for(const A of["x","y"])g[A][S[A]]||(I[A]=0,S[A]=0);if(I.x>0||I.y>0){m(),w.current=E,N(k,l),C.current=I,y.current=S;return}}C.current={x:0,y:0},y.current={x:0,y:0},m()},[t,k,r,m,i,l,JSON.stringify(R),JSON.stringify(g),N,u,T,h,JSON.stringify(p)])}const Jr={x:{[$.Backward]:!1,[$.Forward]:!1},y:{[$.Backward]:!1,[$.Forward]:!1}};function Qr(e){let{delta:t,disabled:n}=e;const r=vt(t);return Ve(o=>{if(n||!r||!o)return Jr;const i={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[$.Backward]:o.x[$.Backward]||i.x===-1,[$.Forward]:o.x[$.Forward]||i.x===1},y:{[$.Backward]:o.y[$.Backward]||i.y===-1,[$.Forward]:o.y[$.Forward]||i.y===1}}},[n,t,r])}function Zr(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return Ve(o=>{var i;return t==null?null:(i=r??o)!=null?i:null},[r,t])}function eo(e,t){return a.useMemo(()=>e.reduce((n,r)=>{const{sensor:o}=r,i=o.activators.map(l=>({eventName:l.eventName,handler:t(l.handler,r)}));return[...n,...i]},[]),[e,t])}var Xe;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Xe||(Xe={}));var yt;(function(e){e.Optimized="optimized"})(yt||(yt={}));const Jt=new Map;function to(e,t){let{dragging:n,dependencies:r,config:o}=t;const[i,l]=a.useState(null),{frequency:s,measure:c,strategy:u}=o,h=a.useRef(e),f=C(),p=Ue(f),g=a.useCallback(function(y){y===void 0&&(y=[]),!p.current&&l(R=>R===null?y:R.concat(y.filter(w=>!R.includes(w))))},[p]),N=a.useRef(null),m=Ve(y=>{if(f&&!n)return Jt;if(!y||y===Jt||h.current!==e||i!=null){const R=new Map;for(let w of e){if(!w)continue;if(i&&i.length>0&&!i.includes(w.id)&&w.rect.current){R.set(w.id,w.rect.current);continue}const k=w.node.current,T=k?new kt(c(k),k):null;w.rect.current=T,T&&R.set(w.id,T)}return R}return y},[e,i,n,f,c]);return a.useEffect(()=>{h.current=e},[e]),a.useEffect(()=>{f||g()},[n,f]),a.useEffect(()=>{i&&i.length>0&&l(null)},[JSON.stringify(i)]),a.useEffect(()=>{f||typeof s!="number"||N.current!==null||(N.current=setTimeout(()=>{g(),N.current=null},s))},[s,f,g,...r]),{droppableRects:m,measureDroppableContainers:g,measuringScheduled:i!=null};function C(){switch(u){case Xe.Always:return!1;case Xe.BeforeDragging:return n;default:return!n}}}function mn(e,t){return Ve(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function no(e,t){return mn(e,t)}function ro(e){let{callback:t,disabled:n}=e;const r=Dt(t),o=a.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return a.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function ot(e){let{callback:t,disabled:n}=e;const r=Dt(t),o=a.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return a.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function oo(e){return new kt(Te(e),e)}function Qt(e,t,n){t===void 0&&(t=oo);const[r,o]=a.useState(null);function i(){o(c=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=c??n)!=null?u:null}const h=t(e);return JSON.stringify(c)===JSON.stringify(h)?c:h})}const l=ro({callback(c){if(e)for(const u of c){const{type:h,target:f}=u;if(h==="childList"&&f instanceof HTMLElement&&f.contains(e)){i();break}}}}),s=ot({callback:i});return de(()=>{i(),e?(s==null||s.observe(e),l==null||l.observe(document.body,{childList:!0,subtree:!0})):(s==null||s.disconnect(),l==null||l.disconnect())},[e]),r}function io(e){const t=mn(e);return un(e,t)}const Zt=[];function so(e){const t=a.useRef(e),n=Ve(r=>e?r&&r!==Zt&&e&&t.current&&e.parentNode===t.current.parentNode?r:rt(e):Zt,[e]);return a.useEffect(()=>{t.current=e},[e]),n}function ao(e){const[t,n]=a.useState(null),r=a.useRef(e),o=a.useCallback(i=>{const l=ht(i.target);l&&n(s=>s?(s.set(l,xt(l)),new Map(s)):null)},[]);return a.useEffect(()=>{const i=r.current;if(e!==i){l(i);const s=e.map(c=>{const u=ht(c);return u?(u.addEventListener("scroll",o,{passive:!0}),[u,xt(u)]):null}).filter(c=>c!=null);n(s.length?new Map(s):null),r.current=e}return()=>{l(e),l(i)};function l(s){s.forEach(c=>{const u=ht(c);u==null||u.removeEventListener("scroll",o)})}},[o,e]),a.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,l)=>Ee(i,l),se):bn(e):se,[e,t])}function en(e,t){t===void 0&&(t=[]);const n=a.useRef(null);return a.useEffect(()=>{n.current=null},t),a.useEffect(()=>{const r=e!==se;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?Fe(e,n.current):se}function lo(e){a.useEffect(()=>{if(!nt)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function co(e,t){return a.useMemo(()=>e.reduce((n,r)=>{let{eventName:o,handler:i}=r;return n[o]=l=>{i(l,t)},n},{}),[e,t])}function yn(e){return a.useMemo(()=>e?Ir(e):null,[e])}const tn=[];function uo(e,t){t===void 0&&(t=Te);const[n]=e,r=yn(n?G(n):null),[o,i]=a.useState(tn);function l(){i(()=>e.length?e.map(c=>pn(c)?r:new kt(t(c),c)):tn)}const s=ot({callback:l});return de(()=>{s==null||s.disconnect(),l(),e.forEach(c=>s==null?void 0:s.observe(c))},[e]),o}function fo(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return _e(t)?t:e}function ho(e){let{measure:t}=e;const[n,r]=a.useState(null),o=a.useCallback(u=>{for(const{target:h}of u)if(_e(h)){r(f=>{const p=t(h);return f?{...f,width:p.width,height:p.height}:p});break}},[t]),i=ot({callback:o}),l=a.useCallback(u=>{const h=fo(u);i==null||i.disconnect(),h&&(i==null||i.observe(h)),r(h?t(h):null)},[t,i]),[s,c]=Qe(l);return a.useMemo(()=>({nodeRef:s,rect:n,setRef:c}),[n,s,c])}const go=[{sensor:jt,options:{}},{sensor:Nt,options:{}}],po={current:{}},Je={draggable:{measure:Wt},droppable:{measure:Wt,strategy:Xe.WhileDragging,frequency:yt.Optimized},dragOverlay:{measure:Te}};class Be extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const vo={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Be,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ze},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Je,measureDroppableContainers:Ze,windowRect:null,measuringScheduled:!1},bo={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ze,draggableNodes:new Map,over:null,measureDroppableContainers:Ze},it=a.createContext(bo),wn=a.createContext(vo);function xo(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Be}}}function mo(e,t){switch(t.type){case P.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case P.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case P.DragEnd:case P.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case P.RegisterDroppable:{const{element:n}=t,{id:r}=n,o=new Be(e.droppable.containers);return o.set(r,n),{...e,droppable:{...e.droppable,containers:o}}}case P.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const l=new Be(e.droppable.containers);return l.set(n,{...i,disabled:o}),{...e,droppable:{...e.droppable,containers:l}}}case P.UnregisterDroppable:{const{id:n,key:r}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const i=new Be(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function yo(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:o}=a.useContext(it),i=vt(r),l=vt(n==null?void 0:n.id);return a.useEffect(()=>{if(!t&&!r&&i&&l!=null){if(!Rt(i)||document.activeElement===i.target)return;const s=o.get(l);if(!s)return;const{activatorNode:c,node:u}=s;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const h of[c.current,u.current]){if(!h)continue;const f=ur(h);if(f){f.focus();break}}})}},[r,t,o,l,i]),null}function wo(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((o,i)=>i({transform:o,...r}),n):n}function Co(e){return a.useMemo(()=>({draggable:{...Je.draggable,...e==null?void 0:e.draggable},droppable:{...Je.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Je.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function So(e){let{activeNode:t,measure:n,initialRect:r,config:o=!0}=e;const i=a.useRef(!1),{x:l,y:s}=typeof o=="boolean"?{x:o,y:o}:o;de(()=>{if(!l&&!s||!t){i.current=!1;return}if(i.current||!r)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const h=n(u),f=un(h,r);if(l||(f.x=0),s||(f.y=0),i.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const p=fn(u);p&&p.scrollBy({top:f.y,left:f.x})}},[t,l,s,r,n])}const Cn=a.createContext({...se,scaleX:1,scaleY:1});var xe;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(xe||(xe={}));const Do=a.memo(function(t){var n,r,o,i;let{id:l,accessibility:s,autoScroll:c=!0,children:u,sensors:h=go,collisionDetection:f=kr,measuring:p,modifiers:g,...N}=t;const m=a.useReducer(mo,void 0,xo),[C,y]=m,[R,w]=br(),[k,T]=a.useState(xe.Uninitialized),E=k===xe.Initialized,{draggable:{active:v,nodes:b,translate:S},droppable:{containers:I}}=C,A=v!=null?b.get(v):null,_=a.useRef({initial:null,translated:null}),q=a.useMemo(()=>{var H;return v!=null?{id:v,data:(H=A==null?void 0:A.data)!=null?H:po,rect:_}:null},[v,A]),ee=a.useRef(null),[ae,we]=a.useState(null),[X,Ce]=a.useState(null),re=Ue(N,Object.values(N)),me=Ye("DndDescribedBy",l),ye=a.useMemo(()=>I.getEnabled(),[I]),U=Co(p),{droppableRects:oe,measureDroppableContainers:x,measuringScheduled:O}=to(ye,{dragging:E,dependencies:[S.x,S.y],config:U.droppable}),D=Zr(b,v),ie=a.useMemo(()=>X?bt(X):null,[X]),L=zn(),z=no(D,U.draggable.measure);So({activeNode:v!=null?b.get(v):null,config:L.layoutShiftCompensation,initialRect:z,measure:U.draggable.measure});const j=Qt(D,U.draggable.measure,z),V=Qt(D?D.parentElement:null),F=a.useRef({activatorEvent:null,active:null,activeNode:D,collisionRect:null,collisions:null,droppableRects:oe,draggableNodes:b,draggingNode:null,draggingNodeRect:null,droppableContainers:I,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),fe=I.getNodeFor((n=F.current.over)==null?void 0:n.id),K=ho({measure:U.dragOverlay.measure}),Se=(r=K.nodeRef.current)!=null?r:D,De=E?(o=K.rect)!=null?o:j:null,Tt=!!(K.nodeRef.current&&K.rect),At=io(Tt?null:j),st=yn(Se?G(Se):null),he=so(E?fe??D:null),We=uo(he),Ge=wo(g,{transform:{x:S.x-At.x,y:S.y-At.y,scaleX:1,scaleY:1},activatorEvent:X,active:q,activeNodeRect:j,containerNodeRect:V,draggingNodeRect:De,over:F.current.over,overlayNodeRect:K.rect,scrollableAncestors:he,scrollableAncestorRects:We,windowRect:st}),It=ie?Ee(ie,S):null,Ot=ao(he),En=en(Ot),jn=en(Ot,[j]),Re=Ee(Ge,En),ke=De?jr(De,Ge):null,Ae=q&&ke?f({active:q,collisionRect:ke,droppableRects:oe,droppableContainers:ye,pointerCoordinates:It}):null,zt=dn(Ae,"id"),[ge,Lt]=a.useState(null),Mn=Tt?Ge:Ee(Ge,jn),Tn=Nr(Mn,(i=ge==null?void 0:ge.rect)!=null?i:null,j),at=a.useRef(null),Pt=a.useCallback((H,J)=>{let{sensor:Q,options:pe}=J;if(ee.current==null)return;const te=b.get(ee.current);if(!te)return;const Z=H.nativeEvent,le=new Q({active:ee.current,activeNode:te,event:Z,options:pe,context:F,onAbort(B){if(!b.get(B))return;const{onDragAbort:ce}=re.current,ue={id:B};ce==null||ce(ue),R({type:"onDragAbort",event:ue})},onPending(B,ve,ce,ue){if(!b.get(B))return;const{onDragPending:Oe}=re.current,be={id:B,constraint:ve,initialCoordinates:ce,offset:ue};Oe==null||Oe(be),R({type:"onDragPending",event:be})},onStart(B){const ve=ee.current;if(ve==null)return;const ce=b.get(ve);if(!ce)return;const{onDragStart:ue}=re.current,Ie={activatorEvent:Z,active:{id:ve,data:ce.data,rect:_}};Le.unstable_batchedUpdates(()=>{ue==null||ue(Ie),T(xe.Initializing),y({type:P.DragStart,initialCoordinates:B,active:ve}),R({type:"onDragStart",event:Ie}),we(at.current),Ce(Z)})},onMove(B){y({type:P.DragMove,coordinates:B})},onEnd:Ne(P.DragEnd),onCancel:Ne(P.DragCancel)});at.current=le;function Ne(B){return async function(){const{active:ce,collisions:ue,over:Ie,scrollAdjustedTranslate:Oe}=F.current;let be=null;if(ce&&Oe){const{cancelDrop:ze}=re.current;be={activatorEvent:Z,active:ce,collisions:ue,delta:Oe,over:Ie},B===P.DragEnd&&typeof ze=="function"&&await Promise.resolve(ze(be))&&(B=P.DragCancel)}ee.current=null,Le.unstable_batchedUpdates(()=>{y({type:B}),T(xe.Uninitialized),Lt(null),we(null),Ce(null),at.current=null;const ze=B===P.DragEnd?"onDragEnd":"onDragCancel";if(be){const lt=re.current[ze];lt==null||lt(be),R({type:ze,event:be})}})}}},[b]),An=a.useCallback((H,J)=>(Q,pe)=>{const te=Q.nativeEvent,Z=b.get(pe);if(ee.current!==null||!Z||te.dndKit||te.defaultPrevented)return;const le={active:Z};H(Q,J.options,le)===!0&&(te.dndKit={capturedBy:J.sensor},ee.current=pe,Pt(Q,J))},[b,Pt]),$t=eo(h,An);lo(h),de(()=>{j&&k===xe.Initializing&&T(xe.Initialized)},[j,k]),a.useEffect(()=>{const{onDragMove:H}=re.current,{active:J,activatorEvent:Q,collisions:pe,over:te}=F.current;if(!J||!Q)return;const Z={active:J,activatorEvent:Q,collisions:pe,delta:{x:Re.x,y:Re.y},over:te};Le.unstable_batchedUpdates(()=>{H==null||H(Z),R({type:"onDragMove",event:Z})})},[Re.x,Re.y]),a.useEffect(()=>{const{active:H,activatorEvent:J,collisions:Q,droppableContainers:pe,scrollAdjustedTranslate:te}=F.current;if(!H||ee.current==null||!J||!te)return;const{onDragOver:Z}=re.current,le=pe.get(zt),Ne=le&&le.rect.current?{id:le.id,rect:le.rect.current,data:le.data,disabled:le.disabled}:null,B={active:H,activatorEvent:J,collisions:Q,delta:{x:te.x,y:te.y},over:Ne};Le.unstable_batchedUpdates(()=>{Lt(Ne),Z==null||Z(B),R({type:"onDragOver",event:B})})},[zt]),de(()=>{F.current={activatorEvent:X,active:q,activeNode:D,collisionRect:ke,collisions:Ae,droppableRects:oe,draggableNodes:b,draggingNode:Se,draggingNodeRect:De,droppableContainers:I,over:ge,scrollableAncestors:he,scrollAdjustedTranslate:Re},_.current={initial:De,translated:ke}},[q,D,Ae,ke,b,Se,De,oe,I,ge,he,Re]),Kr({...L,delta:S,draggingRect:ke,pointerCoordinates:It,scrollableAncestors:he,scrollableAncestorRects:We});const In=a.useMemo(()=>({active:q,activeNode:D,activeNodeRect:j,activatorEvent:X,collisions:Ae,containerNodeRect:V,dragOverlay:K,draggableNodes:b,droppableContainers:I,droppableRects:oe,over:ge,measureDroppableContainers:x,scrollableAncestors:he,scrollableAncestorRects:We,measuringConfiguration:U,measuringScheduled:O,windowRect:st}),[q,D,j,X,Ae,V,K,b,I,oe,ge,x,he,We,U,O,st]),On=a.useMemo(()=>({activatorEvent:X,activators:$t,active:q,activeNodeRect:j,ariaDescribedById:{draggable:me},dispatch:y,draggableNodes:b,over:ge,measureDroppableContainers:x}),[X,$t,q,j,y,me,b,ge,x]);return Y.createElement(an.Provider,{value:w},Y.createElement(it.Provider,{value:On},Y.createElement(wn.Provider,{value:In},Y.createElement(Cn.Provider,{value:Tn},u)),Y.createElement(yo,{disabled:(s==null?void 0:s.restoreFocus)===!1})),Y.createElement(yr,{...s,hiddenTextDescribedById:me}));function zn(){const H=(ae==null?void 0:ae.autoScrollEnabled)===!1,J=typeof c=="object"?c.enabled===!1:c===!1,Q=E&&!H&&!J;return typeof c=="object"?{...c,enabled:Q}:{enabled:Q}}}),Ro=a.createContext(null),nn="button",ko="Draggable";function No(e){let{id:t,data:n,disabled:r=!1,attributes:o}=e;const i=Ye(ko),{activators:l,activatorEvent:s,active:c,activeNodeRect:u,ariaDescribedById:h,draggableNodes:f,over:p}=a.useContext(it),{role:g=nn,roleDescription:N="draggable",tabIndex:m=0}=o??{},C=(c==null?void 0:c.id)===t,y=a.useContext(C?Cn:Ro),[R,w]=Qe(),[k,T]=Qe(),E=co(l,t),v=Ue(n);de(()=>(f.set(t,{id:t,key:i,node:R,activatorNode:k,data:v}),()=>{const S=f.get(t);S&&S.key===i&&f.delete(t)}),[f,t]);const b=a.useMemo(()=>({role:g,tabIndex:m,"aria-disabled":r,"aria-pressed":C&&g===nn?!0:void 0,"aria-roledescription":N,"aria-describedby":h.draggable}),[r,g,m,C,N,h.draggable]);return{active:c,activatorEvent:s,activeNodeRect:u,attributes:b,isDragging:C,listeners:r?void 0:E,node:R,over:p,setNodeRef:w,setActivatorNodeRef:T,transform:y}}function Eo(){return a.useContext(wn)}const jo="Droppable",Mo={timeout:25};function To(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:o}=e;const i=Ye(jo),{active:l,dispatch:s,over:c,measureDroppableContainers:u}=a.useContext(it),h=a.useRef({disabled:n}),f=a.useRef(!1),p=a.useRef(null),g=a.useRef(null),{disabled:N,updateMeasurementsFor:m,timeout:C}={...Mo,...o},y=Ue(m??r),R=a.useCallback(()=>{if(!f.current){f.current=!0;return}g.current!=null&&clearTimeout(g.current),g.current=setTimeout(()=>{u(Array.isArray(y.current)?y.current:[y.current]),g.current=null},C)},[C]),w=ot({callback:R,disabled:N||!l}),k=a.useCallback((b,S)=>{w&&(S&&(w.unobserve(S),f.current=!1),b&&w.observe(b))},[w]),[T,E]=Qe(k),v=Ue(t);return a.useEffect(()=>{!w||!T.current||(w.disconnect(),f.current=!1,w.observe(T.current))},[T,w]),a.useEffect(()=>(s({type:P.RegisterDroppable,element:{id:r,key:i,disabled:n,node:T,rect:p,data:v}}),()=>s({type:P.UnregisterDroppable,key:i,id:r})),[r]),a.useEffect(()=>{n!==h.current.disabled&&(s({type:P.SetDroppableDisabled,id:r,key:i,disabled:n}),h.current.disabled=n)},[r,i,n,s]),{active:l,rect:p,isOver:(c==null?void 0:c.id)===r,node:T,over:c,setNodeRef:E}}function Mt(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function Ao(e,t){return e.reduce((n,r,o)=>{const i=t.get(r);return i&&(n[o]=i),n},Array(e.length))}function qe(e){return e!==null&&e>=0}function Io(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Oo(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Sn=e=>{let{rects:t,activeIndex:n,overIndex:r,index:o}=e;const i=Mt(t,r,n),l=t[o],s=i[o];return!s||!l?null:{x:s.left-l.left,y:s.top-l.top,scaleX:s.width/l.width,scaleY:s.height/l.height}},Ke={scaleX:1,scaleY:1},zo=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:o,rects:i,overIndex:l}=e;const s=(t=i[n])!=null?t:r;if(!s)return null;if(o===n){const u=i[l];return u?{x:0,y:n<l?u.top+u.height-(s.top+s.height):u.top-s.top,...Ke}:null}const c=Lo(i,o,n);return o>n&&o<=l?{x:0,y:-s.height-c,...Ke}:o<n&&o>=l?{x:0,y:s.height+c,...Ke}:{x:0,y:0,...Ke}};function Lo(e,t,n){const r=e[t],o=e[t-1],i=e[t+1];return r?n<t?o?r.top-(o.top+o.height):i?i.top-(r.top+r.height):0:i?i.top-(r.top+r.height):o?r.top-(o.top+o.height):0:0}const Dn="Sortable",Rn=Y.createContext({activeIndex:-1,containerId:Dn,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Sn,disabled:{draggable:!1,droppable:!1}});function Po(e){let{children:t,id:n,items:r,strategy:o=Sn,disabled:i=!1}=e;const{active:l,dragOverlay:s,droppableRects:c,over:u,measureDroppableContainers:h}=Eo(),f=Ye(Dn,n),p=s.rect!==null,g=a.useMemo(()=>r.map(E=>typeof E=="object"&&"id"in E?E.id:E),[r]),N=l!=null,m=l?g.indexOf(l.id):-1,C=u?g.indexOf(u.id):-1,y=a.useRef(g),R=!Io(g,y.current),w=C!==-1&&m===-1||R,k=Oo(i);de(()=>{R&&N&&h(g)},[R,g,N,h]),a.useEffect(()=>{y.current=g},[g]);const T=a.useMemo(()=>({activeIndex:m,containerId:f,disabled:k,disableTransforms:w,items:g,overIndex:C,useDragOverlay:p,sortedRects:Ao(g,c),strategy:o}),[m,f,k.draggable,k.droppable,w,g,C,c,p,o]);return Y.createElement(Rn.Provider,{value:T},t)}const $o=e=>{let{id:t,items:n,activeIndex:r,overIndex:o}=e;return Mt(n,r,o).indexOf(t)},Bo=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:o,items:i,newIndex:l,previousItems:s,previousContainerId:c,transition:u}=e;return!u||!r||s!==i&&o===l?!1:n?!0:l!==o&&t===c},Uo={duration:200,easing:"ease"},kn="transform",Fo=He.Transition.toString({property:kn,duration:0,easing:"linear"}),Ho={roleDescription:"sortable"};function Xo(e){let{disabled:t,index:n,node:r,rect:o}=e;const[i,l]=a.useState(null),s=a.useRef(n);return de(()=>{if(!t&&n!==s.current&&r.current){const c=o.current;if(c){const u=Te(r.current,{ignoreTransform:!0}),h={x:c.left-u.left,y:c.top-u.top,scaleX:c.width/u.width,scaleY:c.height/u.height};(h.x||h.y)&&l(h)}}n!==s.current&&(s.current=n)},[t,n,r,o]),a.useEffect(()=>{i&&l(null)},[i]),i}function _o(e){let{animateLayoutChanges:t=Bo,attributes:n,disabled:r,data:o,getNewIndex:i=$o,id:l,strategy:s,resizeObserverConfig:c,transition:u=Uo}=e;const{items:h,containerId:f,activeIndex:p,disabled:g,disableTransforms:N,sortedRects:m,overIndex:C,useDragOverlay:y,strategy:R}=a.useContext(Rn),w=Vo(r,g),k=h.indexOf(l),T=a.useMemo(()=>({sortable:{containerId:f,index:k,items:h},...o}),[f,o,k,h]),E=a.useMemo(()=>h.slice(h.indexOf(l)),[h,l]),{rect:v,node:b,isOver:S,setNodeRef:I}=To({id:l,data:T,disabled:w.droppable,resizeObserverConfig:{updateMeasurementsFor:E,...c}}),{active:A,activatorEvent:_,activeNodeRect:q,attributes:ee,setNodeRef:ae,listeners:we,isDragging:X,over:Ce,setActivatorNodeRef:re,transform:me}=No({id:l,data:T,attributes:{...Ho,...n},disabled:w.draggable}),ye=ar(I,ae),U=!!A,oe=U&&!N&&qe(p)&&qe(C),x=!y&&X,O=x&&oe?me:null,ie=oe?O??(s??R)({rects:m,activeNodeRect:q,activeIndex:p,overIndex:C,index:k}):null,L=qe(p)&&qe(C)?i({id:l,items:h,activeIndex:p,overIndex:C}):k,z=A==null?void 0:A.id,j=a.useRef({activeId:z,items:h,newIndex:L,containerId:f}),V=h!==j.current.items,F=t({active:A,containerId:f,isDragging:X,isSorting:U,id:l,index:k,items:h,newIndex:j.current.newIndex,previousItems:j.current.items,previousContainerId:j.current.containerId,transition:u,wasDragging:j.current.activeId!=null}),fe=Xo({disabled:!F,index:k,node:b,rect:v});return a.useEffect(()=>{U&&j.current.newIndex!==L&&(j.current.newIndex=L),f!==j.current.containerId&&(j.current.containerId=f),h!==j.current.items&&(j.current.items=h)},[U,L,f,h]),a.useEffect(()=>{if(z===j.current.activeId)return;if(z!=null&&j.current.activeId==null){j.current.activeId=z;return}const Se=setTimeout(()=>{j.current.activeId=z},50);return()=>clearTimeout(Se)},[z]),{active:A,activeIndex:p,attributes:ee,data:T,rect:v,index:k,newIndex:L,items:h,isOver:S,isSorting:U,isDragging:X,listeners:we,node:b,overIndex:C,over:Ce,setNodeRef:ye,setActivatorNodeRef:re,setDroppableNodeRef:I,setDraggableNodeRef:ae,transform:fe??ie,transition:K()};function K(){if(fe||V&&j.current.newIndex===k)return Fo;if(!(x&&!Rt(_)||!u)&&(U||F))return He.Transition.toString({...u,property:kn})}}function Vo(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function tt(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Yo=[M.Down,M.Right,M.Up,M.Left],Wo=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:o,droppableContainers:i,over:l,scrollableAncestors:s}}=t;if(Yo.includes(e.code)){if(e.preventDefault(),!n||!r)return;const c=[];i.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const p=o.get(f.id);if(p)switch(e.code){case M.Down:r.top<p.top&&c.push(f);break;case M.Up:r.top>p.top&&c.push(f);break;case M.Left:r.left>p.left&&c.push(f);break;case M.Right:r.left<p.left&&c.push(f);break}});const u=Dr({collisionRect:r,droppableRects:o,droppableContainers:c});let h=dn(u,"id");if(h===(l==null?void 0:l.id)&&u.length>1&&(h=u[1].id),h!=null){const f=i.get(n.id),p=i.get(h),g=p?o.get(p.id):null,N=p==null?void 0:p.node.current;if(N&&g&&f&&p){const C=rt(N).some((E,v)=>s[v]!==E),y=Nn(f,p),R=Go(f,p),w=C||!y?{x:0,y:0}:{x:R?r.width-g.width:0,y:R?r.height-g.height:0},k={x:g.left,y:g.top};return w.x&&w.y?k:Fe(k,w)}}}};function Nn(e,t){return!tt(e)||!tt(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Go(e,t){return!tt(e)||!tt(t)||!Nn(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}function qo({id:e,children:t,editMode:n}){const{attributes:r,listeners:o,setNodeRef:i,transform:l,transition:s,isDragging:c}=_o({id:e}),u={transform:He.Transform.toString(l),transition:s,zIndex:c?50:"auto",opacity:c?.3:1};return d.jsxs("div",{ref:i,style:u,className:"relative",children:[n&&d.jsx("div",{...r,...o,className:"absolute left-[-40px] top-6 p-2 cursor-grab active:cursor-grabbing text-gray-500 hover:text-white transition-colors touch-none",title:"Trascina per riordinare",children:d.jsx(Jn,{size:24})}),t]})}const Ko=({onFormat:e,onUndo:t,visible:n,canUndo:r})=>{const[o,i]=a.useState(!1),l=[{name:"Verde",value:"#00ff85"},{name:"Rosso",value:"#ff4444"},{name:"Azzurro",value:"#00d4ff"},{name:"Rosa",value:"#ff2882"},{name:"Viola",value:"#a855f7"},{name:"Giallo",value:"#fbbf24"},{name:"Bianco",value:"#ffffff"},{name:"Grigio",value:"#9ca3af"}];return n?d.jsxs("div",{className:"fixed right-4 top-1/2 -translate-y-1/2 bg-pl-dark/95 backdrop-blur-lg border border-white/20 rounded-xl shadow-2xl p-4 z-40 w-64",children:[d.jsxs("div",{className:"flex items-center justify-between mb-3",children:[d.jsx("h3",{className:"text-white font-bold text-sm",children:"Formatta Testo"}),d.jsx("button",{onMouseDown:s=>{s.preventDefault(),t()},disabled:!r,className:`p-2 rounded-lg transition ${r?"bg-yellow-500/20 hover:bg-yellow-500/30 text-yellow-400":"bg-white/5 text-gray-500 cursor-not-allowed"}`,title:"Annulla (Undo)",children:d.jsx(nr,{size:16})})]}),d.jsxs("div",{className:"mb-3",children:[d.jsx("p",{className:"text-gray-400 text-xs mb-2",children:"Stile"}),d.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[d.jsx("button",{onMouseDown:s=>{s.preventDefault(),e("strong")},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition",title:"Grassetto",children:d.jsx(qn,{size:18})}),d.jsx("button",{onMouseDown:s=>{s.preventDefault(),e("em")},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition",title:"Corsivo",children:d.jsx(Qn,{size:18})}),d.jsx("button",{onMouseDown:s=>{s.preventDefault(),e("u")},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition",title:"Sottolineato",children:d.jsx(tr,{size:18})})]})]}),d.jsxs("div",{className:"mb-3",children:[d.jsx("p",{className:"text-gray-400 text-xs mb-2",children:"Dimensione"}),d.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[d.jsxs("button",{onMouseDown:s=>{s.preventDefault(),e("font-size-increase")},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition flex items-center justify-center gap-1",title:"Aumenta",children:[d.jsx(rn,{size:16}),d.jsx(Ut,{size:16})]}),d.jsxs("button",{onMouseDown:s=>{s.preventDefault(),e("font-size-decrease")},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition flex items-center justify-center gap-1",title:"Diminuisci",children:[d.jsx(Hn,{size:16}),d.jsx(Ut,{size:16})]})]})]}),d.jsxs("div",{className:"mb-3",children:[d.jsx("p",{className:"text-gray-400 text-xs mb-2",children:"Allineamento"}),d.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[d.jsx("button",{onMouseDown:s=>{s.preventDefault(),e("align-left")},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition",title:"Sinistra",children:d.jsx(Yn,{size:16})}),d.jsx("button",{onMouseDown:s=>{s.preventDefault(),e("align-center")},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition",title:"Centro",children:d.jsx(_n,{size:16})}),d.jsx("button",{onMouseDown:s=>{s.preventDefault(),e("align-right")},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition",title:"Destra",children:d.jsx(Wn,{size:16})}),d.jsx("button",{onMouseDown:s=>{s.preventDefault(),e("align-justify")},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition",title:"Giustificato",children:d.jsx(Vn,{size:16})})]})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("p",{className:"text-gray-400 text-xs",children:"Colore"}),d.jsx("button",{onMouseDown:s=>{s.preventDefault(),i(!o)},className:"p-1 bg-white/10 hover:bg-white/20 rounded text-white transition",children:d.jsx(Zn,{size:16})})]}),o&&d.jsx("div",{className:"grid grid-cols-4 gap-2",children:l.map(s=>d.jsx("button",{onMouseDown:c=>{c.preventDefault(),e("color",s.value),i(!1)},className:"w-8 h-8 rounded-lg border-2 border-white/20 hover:border-white/50 transition",style:{backgroundColor:s.value},title:s.name},s.value))})]}),d.jsx("div",{className:"mt-3 pt-3 border-t border-white/10",children:d.jsx("p",{className:"text-gray-400 text-xs",children:"Seleziona testo nella textarea per formattare"})})]}):null};function ti(){const{user:e,hasRole:t}=wt(),{loading:n,saving:r,cenniPrincipali:o,sections:i,undoHistory:l,setCenniPrincipali:s,setSections:c,loadRules:u,saveRules:h,updateSection:f,addSection:p,removeSection:g,addToUndoHistory:N,undo:m,clearUndoHistory:C}=or(),[y,R]=a.useState(!1),[w,k]=a.useState(null),[T,E]=a.useState(!1),[v,b]=a.useState(!1),[S,I]=a.useState(null),[A,_]=a.useState(null),q=a.useRef(null),ee=a.useRef(null),ae=a.useRef({}),we=wr(_t(jt),_t(Nt,{coordinateGetter:Wo})),X=x=>{const{active:O,over:D}=x;O.id!==(D==null?void 0:D.id)&&D&&c(ie=>{const L=ie.findIndex(j=>j.id===O.id),z=ie.findIndex(j=>j.id===D.id);return Mt(ie,L,z)})};a.useEffect(()=>{if(!y||!t("admin")){b(!1);return}const x=O=>{const D=O.target;D.tagName==="TEXTAREA"&&D.selectionStart!==D.selectionEnd?(I(D),_({start:D.selectionStart,end:D.selectionEnd}),b(!0)):setTimeout(()=>{D.tagName==="TEXTAREA"&&D.selectionStart===D.selectionEnd&&(b(!1),_(null))},100)};return document.addEventListener("selectionchange",x),document.addEventListener("mouseup",x),()=>{document.removeEventListener("selectionchange",x),document.removeEventListener("mouseup",x)}},[y,t]);const Ce=(x,O)=>{if(!S||!A)return;const{start:D,end:ie}=A,L=S.value.substring(D,ie);if(!L)return;let z="";switch(x){case"strong":z=`<strong>${L}</strong>`;break;case"em":z=`<em>${L}</em>`;break;case"u":z=`<u>${L}</u>`;break;case"font-size-increase":z=`<span style="font-size: 1.2em;">${L}</span>`;break;case"font-size-decrease":z=`<span style="font-size: 0.9em;">${L}</span>`;break;case"color":z=`<span style="color: ${O};">${L}</span>`;break;case"align-left":z=`<div style="text-align: left;">${L}</div>`;break;case"align-center":z=`<div style="text-align: center;">${L}</div>`;break;case"align-right":z=`<div style="text-align: right;">${L}</div>`;break;case"align-justify":z=`<div style="text-align: justify;">${L}</div>`;break;default:return}const j=S.value.substring(0,D)+z+S.value.substring(ie),V=S.getAttribute("data-field");if(V&&N(V,S.value),V==="mainText")s(F=>({...F,mainText:j}));else if(V==="partecipanti")s(F=>({...F,partecipanti:j}));else if(V!=null&&V.startsWith("section-")){const F=parseInt(V.replace("section-",""));c(fe=>fe.map(K=>K.id===F?{...K,content:j}:K))}setTimeout(()=>{S&&(S.focus(),S.setSelectionRange(D+z.length,D+z.length))},50)},re=()=>{m(),b(!0)},me=async()=>{await h()?(alert("Regolamento salvato con successo!"),R(!1),C()):alert("Errore durante il salvataggio.")},ye=x=>{k(x),E(!0),setTimeout(()=>{var O;(O=ae.current[x])==null||O.scrollIntoView({behavior:"smooth",block:"start"})},100)},U=()=>{const x=document.querySelector("main");x&&(x.scrollTop=0),setTimeout(()=>{k(null),E(!1)},100)},oe=x=>{w===x?(k(null),E(!1)):(k(x),E(!1),setTimeout(()=>{var O;(O=ae.current[x])==null||O.scrollIntoView({behavior:"smooth",block:"start"})},100))};return n?d.jsx("div",{className:"min-h-screen bg-pl-dark flex items-center justify-center",children:d.jsx("div",{className:"text-white text-xl",children:"Caricamento regolamento..."})}):d.jsx("div",{className:"min-h-screen bg-pl-dark py-8 md:py-12",children:d.jsxs("div",{ref:q,className:"max-w-6xl mx-auto px-4",children:[d.jsx("div",{className:"relative mb-10 md:mb-14",children:d.jsxs("div",{className:"relative flex flex-col md:flex-row items-center justify-between gap-6",children:[d.jsxs("div",{className:"flex items-center gap-5",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-pl-pink to-pl-purple rounded-2xl blur-lg opacity-50"}),d.jsx("div",{className:"relative bg-gradient-to-br from-pl-pink to-pl-purple p-4 rounded-2xl",children:d.jsx($n,{className:"w-10 h-10 text-white"})})]}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl md:text-5xl font-black bg-gradient-to-r from-white via-gray-100 to-gray-300 bg-clip-text text-transparent pb-1",children:"Regolamento"}),y&&t("admin")?d.jsx("input",{type:"text",value:o.subtitle||"PianginaCUP • Stagione 2025/26",onChange:x=>s(O=>({...O,subtitle:x.target.value})),className:"text-gray-400 text-sm md:text-base mt-1 font-medium tracking-wide bg-transparent border-b border-pl-pink/30 focus:outline-none focus:border-pl-pink w-full"}):d.jsx("p",{className:"text-gray-400 text-sm md:text-base mt-1 font-medium tracking-wide",children:o.subtitle||"PianginaCUP • Stagione 2025/26"})]})]}),t("admin")&&d.jsx("div",{className:"flex gap-3",children:y?d.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-pl-pink/10 border border-pl-pink/30 rounded-xl",children:[d.jsx("div",{className:"w-2 h-2 bg-pl-pink rounded-full animate-pulse"}),d.jsx("span",{className:"text-pl-pink text-sm font-medium",children:"Modifica Attiva"})]}):d.jsxs("button",{onClick:()=>R(!0),className:"group flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-pl-pink/20 to-pl-purple/20 hover:from-pl-pink/30 hover:to-pl-purple/30 rounded-xl text-white border border-pl-pink/30 hover:border-pl-pink/50 transition-all duration-300",children:[d.jsx(er,{size:18,className:"group-hover:rotate-12 transition-transform"}),d.jsx("span",{className:"font-semibold",children:"Modifica"})]})})]})}),y&&t("admin")&&d.jsxs("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 bg-[#18181b]/95 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl shadow-black/50 px-6 py-4 z-50 flex gap-4",children:[d.jsxs("button",{onClick:me,disabled:r,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-green-500/20 to-emerald-500/20 hover:from-green-500/30 hover:to-emerald-500/30 rounded-xl text-white border border-green-500/30 transition-all disabled:opacity-50 font-semibold",children:[d.jsx(Bn,{size:18}),r?"Salvataggio...":"Salva"]}),d.jsxs("button",{onClick:()=>{R(!1),C(),u()},className:"flex items-center gap-2 px-6 py-2.5 bg-red-500/10 hover:bg-red-500/20 rounded-xl text-red-400 border border-red-500/20 hover:border-red-500/30 transition-all font-semibold",children:[d.jsx(Un,{size:18}),"Annulla"]})]}),d.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 items-start",children:[d.jsx("div",{className:"w-full lg:w-72 lg:sticky lg:top-8 order-1 space-y-5",children:d.jsxs("div",{ref:ee,className:"group bg-gradient-to-br from-white/[0.08] to-white/[0.02] backdrop-blur-xl rounded-2xl p-5 border border-white/10 hover:border-white/20 transition-all duration-300",children:[d.jsxs("h2",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2.5",children:[d.jsx("div",{className:"p-2 bg-pl-teal/20 rounded-lg",children:d.jsx(Kn,{size:18,className:"text-pl-teal"})}),"Indice"]}),d.jsxs("nav",{className:"flex flex-col gap-1.5",children:[d.jsx("button",{onClick:()=>ye(-1),className:`text-left text-sm font-medium px-3.5 py-2.5 rounded-xl transition-all duration-200 ${w===-1?"bg-pl-teal/20 text-pl-teal border border-pl-teal/30":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:o.title||"1. Cenni Principali"}),i.map((x,O)=>d.jsx("button",{onClick:()=>ye(x.id),className:`text-left text-sm font-medium px-3.5 py-2.5 rounded-xl transition-all duration-200 ${w===x.id?"bg-pl-teal/20 text-pl-teal border border-pl-teal/30":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:x.title},x.id))]})]})}),d.jsxs("div",{className:"flex-1 order-2 space-y-6",children:[d.jsxs("div",{ref:x=>ae.current[-1]=x,className:"relative bg-gradient-to-br from-white/[0.08] to-white/[0.02] backdrop-blur-xl rounded-3xl p-8 md:p-10 border border-white/10 overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-pl-pink via-pl-purple to-pl-teal"}),d.jsx("div",{className:"text-center mb-8",children:y&&t("admin")?d.jsx("input",{type:"text",value:o.title||"1. Cenni Principali e Avvertenze",onChange:x=>s(O=>({...O,title:x.target.value})),className:"text-2xl md:text-3xl font-bold text-pl-teal bg-transparent border-b-2 border-pl-pink/30 focus:outline-none focus:border-pl-pink text-center w-full pb-2"}):d.jsx("h2",{className:"text-2xl md:text-3xl font-bold bg-gradient-to-r from-pl-teal to-emerald-400 bg-clip-text text-transparent",children:o.title||"1. Cenni Principali e Avvertenze"})}),d.jsx("div",{className:"text-gray-300 leading-relaxed space-y-4 text-[15px]",children:d.jsx(Ht,{value:o.mainText,onChange:x=>s(O=>({...O,mainText:x})),editMode:y,multiline:!0,dataField:"mainText"})})]}),d.jsx(Do,{sensors:we,collisionDetection:Sr,onDragEnd:X,children:d.jsx(Po,{items:i.map(x=>x.id),strategy:zo,disabled:!y||!t("admin"),children:d.jsxs("div",{className:"space-y-4",children:[y&&t("admin")&&d.jsxs("button",{onClick:p,className:"w-full flex items-center justify-center gap-2 py-4 bg-gradient-to-r from-pl-teal/10 to-emerald-500/10 hover:from-pl-teal/20 hover:to-emerald-500/20 rounded-2xl text-pl-teal border border-pl-teal/20 hover:border-pl-teal/40 transition-all font-semibold",children:[d.jsx(rn,{size:20}),"Aggiungi Sezione"]}),i.map((x,O)=>d.jsx(qo,{id:x.id,editMode:y&&t("admin"),children:d.jsxs("div",{ref:D=>ae.current[x.id]=D,className:`bg-gradient-to-br from-white/[0.06] to-white/[0.02] backdrop-blur-xl rounded-2xl border transition-all duration-300 overflow-hidden ${w===x.id?"border-white/20 shadow-lg shadow-black/20":"border-white/10 hover:border-white/15"}`,children:[d.jsxs("div",{className:"flex items-center justify-between p-5 md:p-6 cursor-pointer hover:bg-white/[0.02] transition-all group",onClick:()=>oe(x.id),children:[y&&t("admin")?d.jsx("input",{type:"text",value:x.title,onChange:D=>f(x.id,"title",D.target.value),onClick:D=>D.stopPropagation(),className:"flex-1 text-lg md:text-xl font-bold text-white bg-transparent border-b-2 border-pl-pink/30 focus:outline-none focus:border-pl-pink text-center pb-1"}):d.jsx("h3",{className:"flex-1 text-lg md:text-xl font-bold text-white text-center group-hover:text-gray-100 transition-colors",children:x.title}),d.jsx("div",{className:`p-2 rounded-full bg-white/5 group-hover:bg-white/10 transition-all ml-4 ${w===x.id?"bg-pl-teal/20":""}`,children:d.jsx(Fn,{size:20,className:`text-gray-400 transition-all duration-300 ${w===x.id?"rotate-180 text-pl-teal":"group-hover:text-white"}`})}),y&&t("admin")&&d.jsx("button",{onClick:D=>{D.stopPropagation(),g(x.id)},className:"ml-3 p-2.5 bg-red-500/10 hover:bg-red-500/20 rounded-xl text-red-400 border border-red-500/20 hover:border-red-500/30 transition-all",children:d.jsx(Xn,{size:16})})]}),w===x.id&&d.jsxs("div",{className:"px-5 md:px-6 pb-6 pt-2 border-t border-white/5 animate-in slide-in-from-top-2 duration-200",children:[d.jsx("div",{className:"text-gray-300 leading-relaxed space-y-3 text-[15px]",children:d.jsx(Ht,{value:x.content,onChange:D=>f(x.id,"content",D),editMode:y,multiline:!0,dataField:`section-${x.id}`})}),w===x.id&&d.jsxs("button",{onClick:U,className:"mt-6 flex items-center gap-2 px-5 py-2.5 bg-pl-teal/10 hover:bg-pl-teal/20 rounded-xl text-pl-teal border border-pl-teal/20 transition-all mx-auto lg:hidden font-medium",children:[d.jsx(Gn,{size:16}),"Torna all'Indice"]})]})]})},x.id))]})})}),d.jsx("div",{className:"h-8"})]}),y&&t("admin")&&d.jsx(Ko,{visible:v,onFormat:Ce,onUndo:re,canUndo:l.length>0})]})]})})}export{ti as Rules};
