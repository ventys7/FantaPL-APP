import{c as H,r as a,d as ct,D as dt,C as Bt,l as ut,a as Pn,Q as $n,u as wt,j as c,X as rn,R as G,b as Le,S as Bn}from"./index-cjkDwOi3.js";import{P as on,M as Un}from"./plus-Go6ImeAW.js";import{C as Fn,T as _n}from"./trash-2-D0WvvO3v.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=H("AlignCenter",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"17",x2:"7",y1:"12",y2:"12",key:"rsh8ii"}],["line",{x1:"19",x2:"5",y1:"18",y2:"18",key:"1t0tuv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xn=H("AlignJustify",[["line",{x1:"3",x2:"21",y1:"6",y2:"6",key:"4m8b97"}],["line",{x1:"3",x2:"21",y1:"12",y2:"12",key:"10d38w"}],["line",{x1:"3",x2:"21",y1:"18",y2:"18",key:"kwyyxn"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=H("AlignLeft",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}],["line",{x1:"17",x2:"3",y1:"18",y2:"18",key:"1awlsn"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=H("AlignRight",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}],["line",{x1:"21",x2:"7",y1:"18",y2:"18",key:"1g9eri"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=H("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=H("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qn=H("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kn=H("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=H("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=H("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=H("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=H("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=H("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=H("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=H("Underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=H("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5v0a5.5 5.5 0 0 1-5.5 5.5H11",key:"llx8ln"}]]),ir=[{id:2,title:"2. Ruoli Lega",key:"ruoliLega",content:""},{id:3,title:"3. ModalitÃ  Asta, Composizione Rosa, Bonus & Malus",key:"astaRosa",content:""},{id:4,title:"4. Formazione della Squadra",key:"formazione",content:""},{id:5,title:"5. Svolgimento Giornata Campionato",key:"giornata",content:""},{id:6,title:"6. Campionato con Girone e Playoff",key:"campionato",content:""},{id:7,title:"7. Coppa (Coppa Italia e Supercoppa)",key:"coppa",content:""},{id:8,title:"8. Champions/Europa League",key:"champions",content:""},{id:9,title:"9. Mercato e Scambi",key:"mercato",content:""},{id:10,title:"10. Premi",key:"premi",content:""},{id:11,title:"11. Clausole e Punizioni",key:"clausole",content:""},{id:12,title:"12. Conclusione",key:"conclusione",content:""},{id:13,title:"13. Link Utili",key:"link",content:""}],Ft={title:"1. Cenni Principali e Avvertenze",mainText:'Il "PianginaCUP" Ã¨ a titolo gratuito.',partecipanti:`Partecipanti:
1. Manager 1
2. Manager 2`};function or(){const[e,t]=a.useState(!0),[n,r]=a.useState(!1),[i,o]=a.useState(Ft),[l,s]=a.useState(ir),[d,u]=a.useState([]),[h,f]=a.useState([]),[v,g]=a.useState(null),N=async()=>{try{const p=await ct.listDocuments(dt,Bt);if(p.documents.length>0){const b=p.documents[0];if(g(b.$id),b.cenni_main_text&&o({mainText:b.cenni_main_text,partecipanti:b.cenni_partecipanti||Ft.partecipanti}),b.sections_json)try{const C=JSON.parse(b.sections_json);Array.isArray(C)?s(C):C.sections&&(s(C.sections),C.mainTitle&&o(j=>({...j,title:C.mainTitle})))}catch(C){ut.error("Error parsing sections:",C)}}}catch(p){ut.error("Error loading rules:",p)}finally{t(!1)}},x=async()=>{try{const p=await ct.listDocuments(dt,Pn,[$n.orderDesc("archived_at")]);u(p.documents)}catch{u([])}},w=async()=>{if(!v)return!1;r(!0);try{const p={mainTitle:i.title,sections:l};return await ct.updateDocument(dt,Bt,v,{cenni_main_text:i.mainText,cenni_partecipanti:i.partecipanti,sections_json:JSON.stringify(p)}),!0}catch(p){return ut.error("Error saving rules:",p),!1}finally{r(!1)}},D=(p,b,C)=>{s(j=>j.map(I=>I.id===p?{...I,[b]:C}:I))},y=()=>{const p=Math.max(...l.map(b=>b.id))+1;s(b=>[...b,{id:p,title:`${p}. Nuova Sezione`,key:`section${p}`,content:""}])},S=p=>{confirm("Sei sicuro di voler eliminare questa sezione?")&&s(b=>b.filter(C=>C.id!==p))},R=(p,b)=>{f(C=>[...C,{field:p,value:b}])},k=()=>{if(h.length===0)return;const p=h[h.length-1];if(f(b=>b.slice(0,-1)),p.field==="mainText")o(b=>({...b,mainText:p.value}));else if(p.field==="partecipanti")o(b=>({...b,partecipanti:p.value}));else if(p.field.startsWith("section-")){const b=parseInt(p.field.replace("section-",""));s(C=>C.map(j=>j.id===b?{...j,content:p.value}:j))}},A=()=>{f([])};return a.useEffect(()=>{N(),x()},[]),{loading:e,saving:n,cenniPrincipali:i,sections:l,archivedRules:d,undoHistory:h,setCenniPrincipali:o,setSections:s,loadRules:N,saveRules:w,updateSection:D,addSection:y,removeSection:S,addToUndoHistory:R,undo:k,clearUndoHistory:A}}const sr=(e,t)=>t?e.replace(/<blur>(.*?)<\/blur>/gi,(n,r)=>"â–ˆ".repeat(r.length)):e;function ar({children:e}){const{user:t}=wt(),r=sr(e,!t);return c.jsx("span",{dangerouslySetInnerHTML:{__html:r.replace(/\n/g,"<br/>")}})}function _t({value:e,onChange:t,editMode:n,multiline:r=!1,className:i="",textareaRef:o,dataField:l}){const{hasRole:s}=wt();return n&&s("admin")?r?c.jsx("textarea",{ref:o,"data-field":l,value:e,onChange:d=>t(d.target.value),className:`w-full bg-pl-dark/50 border border-pl-pink/30 rounded-lg p-4 text-white focus:outline-none focus:ring-2 focus:ring-pl-pink resize-y min-h-[200px] font-mono text-sm leading-relaxed ${i}`}):c.jsx("input",{type:"text",value:e,onChange:d=>t(d.target.value),className:`w-full bg-pl-dark/50 border border-pl-pink/30 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-pl-pink ${i}`}):c.jsx("div",{className:`leading-relaxed ${i}`,children:c.jsx(ar,{children:e})})}function lr({archive:e,onClose:t}){var n;return c.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-pl-dark border border-white/20 rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[c.jsxs("div",{className:"p-6 border-b border-white/10 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-2xl font-bold text-white",children:["Regolamento Stagione ",e.season]}),c.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["Archiviato il ",new Date(e.archived_at).toLocaleDateString("it-IT")]})]}),c.jsx("button",{onClick:t,className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition",children:c.jsx(rn,{size:24})})]}),c.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:[c.jsxs("div",{className:"mb-8",children:[c.jsx("h4",{className:"text-xl font-bold text-pl-teal mb-4",children:"1. Cenni Principali"}),c.jsx("div",{className:"text-gray-200 leading-relaxed",dangerouslySetInnerHTML:{__html:((n=e.cenni_main_text)==null?void 0:n.replace(/\n/g,"<br/>"))||""}})]}),e.sections_json&&c.jsx("div",{className:"space-y-6",children:JSON.parse(e.sections_json).map(r=>{var i;return c.jsxs("div",{children:[c.jsx("h4",{className:"text-xl font-bold text-pl-teal mb-3",children:r.title}),c.jsx("div",{className:"text-gray-200 leading-relaxed",dangerouslySetInnerHTML:{__html:((i=r.content)==null?void 0:i.replace(/\n/g,"<br/>"))||""}})]},r.id)})})]})]})})}function cr({archives:e}){const[t,n]=a.useState(null);return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"mt-12 bg-white/5 backdrop-blur-xl rounded-2xl p-6 border border-white/20",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[c.jsx(Wn,{className:"w-8 h-8 text-amber-400"}),c.jsx("h2",{className:"text-2xl font-bold text-white",children:"ðŸ“œ Archivio Storico"})]}),e.length===0?c.jsx("p",{className:"text-gray-400 text-center py-8",children:"Nessun regolamento archiviato ancora."}):c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(r=>c.jsxs("button",{onClick:()=>n(r),className:"bg-white/5 hover:bg-white/10 rounded-xl p-4 border border-white/10 hover:border-amber-400/50 transition text-left",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx(Jn,{size:16,className:"text-amber-400"}),c.jsxs("span",{className:"text-lg font-bold text-white",children:["Stagione ",r.season]})]}),c.jsxs("p",{className:"text-gray-400 text-sm",children:["Archiviato il ",new Date(r.archived_at).toLocaleDateString("it-IT",{day:"2-digit",month:"long",year:"numeric"})]})]},r.$id))})]}),t&&c.jsx(lr,{archive:t,onClose:()=>n(null)})]})}function dr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.useMemo(()=>r=>{t.forEach(i=>i(r))},t)}const nt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ee(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function St(e){return"nodeType"in e}function q(e){var t,n;return e?Ee(e)?e:St(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Ct(e){const{Document:t}=q(e);return e instanceof t}function Xe(e){return Ee(e)?!1:e instanceof q(e).HTMLElement}function sn(e){return e instanceof q(e).SVGElement}function Me(e){return e?Ee(e)?e.document:St(e)?Ct(e)?e:Xe(e)||sn(e)?e.ownerDocument:document:document:document}const ce=nt?a.useLayoutEffect:a.useEffect;function Dt(e){const t=a.useRef(e);return ce(()=>{t.current=e}),a.useCallback(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.current==null?void 0:t.current(...r)},[])}function ur(){const e=a.useRef(null),t=a.useCallback((r,i)=>{e.current=setInterval(r,i)},[]),n=a.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Ue(e,t){t===void 0&&(t=[e]);const n=a.useRef(e);return ce(()=>{n.current!==e&&(n.current=e)},t),n}function Ve(e,t){const n=a.useRef();return a.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function Qe(e){const t=Dt(e),n=a.useRef(null),r=a.useCallback(i=>{i!==n.current&&(t==null||t(i,n.current)),n.current=i},[]);return[n,r]}function vt(e){const t=a.useRef();return a.useEffect(()=>{t.current=e},[e]),t.current}let ft={};function Ye(e,t){return a.useMemo(()=>{if(t)return t;const n=ft[e]==null?0:ft[e]+1;return ft[e]=n,e+"-"+n},[e,t])}function an(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.reduce((o,l)=>{const s=Object.entries(l);for(const[d,u]of s){const h=o[d];h!=null&&(o[d]=h+e*u)}return o},{...t})}}const je=an(1),Fe=an(-1);function fr(e){return"clientX"in e&&"clientY"in e}function Rt(e){if(!e)return!1;const{KeyboardEvent:t}=q(e.target);return t&&e instanceof t}function hr(e){if(!e)return!1;const{TouchEvent:t}=q(e.target);return t&&e instanceof t}function bt(e){if(hr(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return fr(e)?{x:e.clientX,y:e.clientY}:null}const _e=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[_e.Translate.toString(e),_e.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),Ht="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function gr(e){return e.matches(Ht)?e:e.querySelector(Ht)}const pr={display:"none"};function vr(e){let{id:t,value:n}=e;return G.createElement("div",{id:t,style:pr},n)}function br(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return G.createElement("div",{id:t,style:i,role:"status","aria-live":r,"aria-atomic":!0},n)}function xr(){const[e,t]=a.useState("");return{announce:a.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const ln=a.createContext(null);function mr(e){const t=a.useContext(ln);a.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function yr(){const[e]=a.useState(()=>new Set),t=a.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[a.useCallback(r=>{let{type:i,event:o}=r;e.forEach(l=>{var s;return(s=l[i])==null?void 0:s.call(l,o)})},[e]),t]}const wr={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Sr={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Cr(e){let{announcements:t=Sr,container:n,hiddenTextDescribedById:r,screenReaderInstructions:i=wr}=e;const{announce:o,announcement:l}=xr(),s=Ye("DndLiveRegion"),[d,u]=a.useState(!1);if(a.useEffect(()=>{u(!0)},[]),mr(a.useMemo(()=>({onDragStart(f){let{active:v}=f;o(t.onDragStart({active:v}))},onDragMove(f){let{active:v,over:g}=f;t.onDragMove&&o(t.onDragMove({active:v,over:g}))},onDragOver(f){let{active:v,over:g}=f;o(t.onDragOver({active:v,over:g}))},onDragEnd(f){let{active:v,over:g}=f;o(t.onDragEnd({active:v,over:g}))},onDragCancel(f){let{active:v,over:g}=f;o(t.onDragCancel({active:v,over:g}))}}),[o,t])),!d)return null;const h=G.createElement(G.Fragment,null,G.createElement(vr,{id:r,value:i.draggable}),G.createElement(br,{id:s,announcement:l}));return n?Le.createPortal(h,n):h}var P;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(P||(P={}));function Ze(){}function Xt(e,t){return a.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function Dr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const se=Object.freeze({x:0,y:0});function cn(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function dn(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function Rr(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function Vt(e){let{left:t,top:n,height:r,width:i}=e;return[{x:t,y:n},{x:t+i,y:n},{x:t,y:n+r},{x:t+i,y:n+r}]}function un(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Yt(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const Nr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const i=Yt(t,t.left,t.top),o=[];for(const l of r){const{id:s}=l,d=n.get(s);if(d){const u=cn(Yt(d),i);o.push({id:s,data:{droppableContainer:l,value:u}})}}return o.sort(dn)},kr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const i=Vt(t),o=[];for(const l of r){const{id:s}=l,d=n.get(s);if(d){const u=Vt(d),h=i.reduce((v,g,N)=>v+cn(u[N],g),0),f=Number((h/4).toFixed(4));o.push({id:s,data:{droppableContainer:l,value:f}})}}return o.sort(dn)};function jr(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),l=i-r,s=o-n;if(r<i&&n<o){const d=t.width*t.height,u=e.width*e.height,h=l*s,f=h/(d+u-h);return Number(f.toFixed(4))}return 0}const Er=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const i=[];for(const o of r){const{id:l}=o,s=n.get(l);if(s){const d=jr(s,t);d>0&&i.push({id:l,data:{droppableContainer:o,value:d}})}}return i.sort(Rr)};function Mr(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function fn(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:se}function Ar(e){return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return i.reduce((l,s)=>({...l,top:l.top+e*s.y,bottom:l.bottom+e*s.y,left:l.left+e*s.x,right:l.right+e*s.x}),{...n})}}const Tr=Ar(1);function Ir(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Or(e,t,n){const r=Ir(t);if(!r)return e;const{scaleX:i,scaleY:o,x:l,y:s}=r,d=e.left-l-(1-i)*parseFloat(n),u=e.top-s-(1-o)*parseFloat(n.slice(n.indexOf(" ")+1)),h=i?e.width/i:e.width,f=o?e.height/o:e.height;return{width:h,height:f,top:u,right:d+h,bottom:u+f,left:d}}const zr={ignoreTransform:!1};function Ae(e,t){t===void 0&&(t=zr);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:h}=q(e).getComputedStyle(e);u&&(n=Or(n,u,h))}const{top:r,left:i,width:o,height:l,bottom:s,right:d}=n;return{top:r,left:i,width:o,height:l,bottom:s,right:d}}function Wt(e){return Ae(e,{ignoreTransform:!0})}function Lr(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Pr(e,t){return t===void 0&&(t=q(e).getComputedStyle(e)),t.position==="fixed"}function $r(e,t){t===void 0&&(t=q(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const o=t[i];return typeof o=="string"?n.test(o):!1})}function rt(e,t){const n=[];function r(i){if(t!=null&&n.length>=t||!i)return n;if(Ct(i)&&i.scrollingElement!=null&&!n.includes(i.scrollingElement))return n.push(i.scrollingElement),n;if(!Xe(i)||sn(i)||n.includes(i))return n;const o=q(e).getComputedStyle(i);return i!==e&&$r(i,o)&&n.push(i),Pr(i,o)?n:r(i.parentNode)}return e?r(e):n}function hn(e){const[t]=rt(e,1);return t??null}function ht(e){return!nt||!e?null:Ee(e)?e:St(e)?Ct(e)||e===Me(e).scrollingElement?window:Xe(e)?e:null:null}function gn(e){return Ee(e)?e.scrollX:e.scrollLeft}function pn(e){return Ee(e)?e.scrollY:e.scrollTop}function xt(e){return{x:gn(e),y:pn(e)}}var $;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})($||($={}));function vn(e){return!nt||!e?!1:e===document.scrollingElement}function bn(e){const t={x:0,y:0},n=vn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},i=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,l=e.scrollTop>=r.y,s=e.scrollLeft>=r.x;return{isTop:i,isLeft:o,isBottom:l,isRight:s,maxScroll:r,minScroll:t}}const Br={x:.2,y:.2};function Ur(e,t,n,r,i){let{top:o,left:l,right:s,bottom:d}=n;r===void 0&&(r=10),i===void 0&&(i=Br);const{isTop:u,isBottom:h,isLeft:f,isRight:v}=bn(e),g={x:0,y:0},N={x:0,y:0},x={height:t.height*i.y,width:t.width*i.x};return!u&&o<=t.top+x.height?(g.y=$.Backward,N.y=r*Math.abs((t.top+x.height-o)/x.height)):!h&&d>=t.bottom-x.height&&(g.y=$.Forward,N.y=r*Math.abs((t.bottom-x.height-d)/x.height)),!v&&s>=t.right-x.width?(g.x=$.Forward,N.x=r*Math.abs((t.right-x.width-s)/x.width)):!f&&l<=t.left+x.width&&(g.x=$.Backward,N.x=r*Math.abs((t.left+x.width-l)/x.width)),{direction:g,speed:N}}function Fr(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:l}=window;return{top:0,left:0,right:o,bottom:l,width:o,height:l}}const{top:t,left:n,right:r,bottom:i}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:i,width:e.clientWidth,height:e.clientHeight}}function xn(e){return e.reduce((t,n)=>je(t,xt(n)),se)}function _r(e){return e.reduce((t,n)=>t+gn(n),0)}function Hr(e){return e.reduce((t,n)=>t+pn(n),0)}function Xr(e,t){if(t===void 0&&(t=Ae),!e)return;const{top:n,left:r,bottom:i,right:o}=t(e);hn(e)&&(i<=0||o<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Vr=[["x",["left","right"],_r],["y",["top","bottom"],Hr]];class Nt{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=rt(n),i=xn(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,l,s]of Vr)for(const d of l)Object.defineProperty(this,d,{get:()=>{const u=s(r),h=i[o]-u;return this.rect[d]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Pe{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var i;(i=this.target)==null||i.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function Yr(e){const{EventTarget:t}=q(e);return e instanceof t?e:Me(e)}function gt(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var ne;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ne||(ne={}));function Gt(e){e.preventDefault()}function Wr(e){e.stopPropagation()}var M;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(M||(M={}));const mn={start:[M.Space,M.Enter],cancel:[M.Esc],end:[M.Space,M.Enter,M.Tab]},Gr=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case M.Right:return{...n,x:n.x+25};case M.Left:return{...n,x:n.x-25};case M.Down:return{...n,y:n.y+25};case M.Up:return{...n,y:n.y-25}}};class kt{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Pe(Me(n)),this.windowListeners=new Pe(q(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ne.Resize,this.handleCancel),this.windowListeners.add(ne.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ne.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&Xr(r),n(se)}handleKeyDown(t){if(Rt(t)){const{active:n,context:r,options:i}=this.props,{keyboardCodes:o=mn,coordinateGetter:l=Gr,scrollBehavior:s="smooth"}=i,{code:d}=t;if(o.end.includes(d)){this.handleEnd(t);return}if(o.cancel.includes(d)){this.handleCancel(t);return}const{collisionRect:u}=r.current,h=u?{x:u.left,y:u.top}:se;this.referenceCoordinates||(this.referenceCoordinates=h);const f=l(t,{active:n,context:r.current,currentCoordinates:h});if(f){const v=Fe(f,h),g={x:0,y:0},{scrollableAncestors:N}=r.current;for(const x of N){const w=t.code,{isTop:D,isRight:y,isLeft:S,isBottom:R,maxScroll:k,minScroll:A}=bn(x),p=Fr(x),b={x:Math.min(w===M.Right?p.right-p.width/2:p.right,Math.max(w===M.Right?p.left:p.left+p.width/2,f.x)),y:Math.min(w===M.Down?p.bottom-p.height/2:p.bottom,Math.max(w===M.Down?p.top:p.top+p.height/2,f.y))},C=w===M.Right&&!y||w===M.Left&&!S,j=w===M.Down&&!R||w===M.Up&&!D;if(C&&b.x!==f.x){const I=x.scrollLeft+v.x,V=w===M.Right&&I<=k.x||w===M.Left&&I>=A.x;if(V&&!v.y){x.scrollTo({left:I,behavior:s});return}V?g.x=x.scrollLeft-I:g.x=w===M.Right?x.scrollLeft-k.x:x.scrollLeft-A.x,g.x&&x.scrollBy({left:-g.x,behavior:s});break}else if(j&&b.y!==f.y){const I=x.scrollTop+v.y,V=w===M.Down&&I<=k.y||w===M.Up&&I>=A.y;if(V&&!v.x){x.scrollTo({top:I,behavior:s});return}V?g.y=x.scrollTop-I:g.y=w===M.Down?x.scrollTop-k.y:x.scrollTop-A.y,g.y&&x.scrollBy({top:-g.y,behavior:s});break}}this.handleMove(t,je(Fe(f,this.referenceCoordinates),g))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}kt.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=mn,onActivation:i}=t,{active:o}=n;const{code:l}=e.nativeEvent;if(r.start.includes(l)){const s=o.activatorNode.current;return s&&e.target!==s?!1:(e.preventDefault(),i==null||i({event:e.nativeEvent}),!0)}return!1}}];function qt(e){return!!(e&&"distance"in e)}function Kt(e){return!!(e&&"delay"in e)}class jt{constructor(t,n,r){var i;r===void 0&&(r=Yr(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:o}=t,{target:l}=o;this.props=t,this.events=n,this.document=Me(l),this.documentListeners=new Pe(this.document),this.listeners=new Pe(r),this.windowListeners=new Pe(q(l)),this.initialCoordinates=(i=bt(o))!=null?i:se,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(ne.Resize,this.handleCancel),this.windowListeners.add(ne.DragStart,Gt),this.windowListeners.add(ne.VisibilityChange,this.handleCancel),this.windowListeners.add(ne.ContextMenu,Gt),this.documentListeners.add(ne.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Kt(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(qt(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:i}=this.props;i(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(ne.Click,Wr,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ne.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:i,props:o}=this,{onMove:l,options:{activationConstraint:s}}=o;if(!i)return;const d=(n=bt(t))!=null?n:se,u=Fe(i,d);if(!r&&s){if(qt(s)){if(s.tolerance!=null&&gt(u,s.tolerance))return this.handleCancel();if(gt(u,s.distance))return this.handleStart()}if(Kt(s)&&gt(u,s.tolerance))return this.handleCancel();this.handlePending(s,u);return}t.cancelable&&t.preventDefault(),l(d)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===M.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const qr={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Et extends jt{constructor(t){const{event:n}=t,r=Me(n.target);super(t,qr,r)}}Et.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const Kr={move:{name:"mousemove"},end:{name:"mouseup"}};var mt;(function(e){e[e.RightClick=2]="RightClick"})(mt||(mt={}));class Jr extends jt{constructor(t){super(t,Kr,Me(t.event.target))}}Jr.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===mt.RightClick?!1:(r==null||r({event:n}),!0)}}];const pt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Qr extends jt{constructor(t){super(t,pt)}static setup(){return window.addEventListener(pt.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(pt.move.name,t)};function t(){}}}Qr.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:i}=n;return i.length>1?!1:(r==null||r({event:n}),!0)}}];var $e;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})($e||($e={}));var et;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(et||(et={}));function Zr(e){let{acceleration:t,activator:n=$e.Pointer,canScroll:r,draggingRect:i,enabled:o,interval:l=5,order:s=et.TreeOrder,pointerCoordinates:d,scrollableAncestors:u,scrollableAncestorRects:h,delta:f,threshold:v}=e;const g=ti({delta:f,disabled:!o}),[N,x]=ur(),w=a.useRef({x:0,y:0}),D=a.useRef({x:0,y:0}),y=a.useMemo(()=>{switch(n){case $e.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case $e.DraggableRect:return i}},[n,i,d]),S=a.useRef(null),R=a.useCallback(()=>{const A=S.current;if(!A)return;const p=w.current.x*D.current.x,b=w.current.y*D.current.y;A.scrollBy(p,b)},[]),k=a.useMemo(()=>s===et.TreeOrder?[...u].reverse():u,[s,u]);a.useEffect(()=>{if(!o||!u.length||!y){x();return}for(const A of k){if((r==null?void 0:r(A))===!1)continue;const p=u.indexOf(A),b=h[p];if(!b)continue;const{direction:C,speed:j}=Ur(A,b,y,t,v);for(const I of["x","y"])g[I][C[I]]||(j[I]=0,C[I]=0);if(j.x>0||j.y>0){x(),S.current=A,N(R,l),w.current=j,D.current=C;return}}w.current={x:0,y:0},D.current={x:0,y:0},x()},[t,R,r,x,o,l,JSON.stringify(y),JSON.stringify(g),N,u,k,h,JSON.stringify(v)])}const ei={x:{[$.Backward]:!1,[$.Forward]:!1},y:{[$.Backward]:!1,[$.Forward]:!1}};function ti(e){let{delta:t,disabled:n}=e;const r=vt(t);return Ve(i=>{if(n||!r||!i)return ei;const o={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[$.Backward]:i.x[$.Backward]||o.x===-1,[$.Forward]:i.x[$.Forward]||o.x===1},y:{[$.Backward]:i.y[$.Backward]||o.y===-1,[$.Forward]:i.y[$.Forward]||o.y===1}}},[n,t,r])}function ni(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return Ve(i=>{var o;return t==null?null:(o=r??i)!=null?o:null},[r,t])}function ri(e,t){return a.useMemo(()=>e.reduce((n,r)=>{const{sensor:i}=r,o=i.activators.map(l=>({eventName:l.eventName,handler:t(l.handler,r)}));return[...n,...o]},[]),[e,t])}var He;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(He||(He={}));var yt;(function(e){e.Optimized="optimized"})(yt||(yt={}));const Jt=new Map;function ii(e,t){let{dragging:n,dependencies:r,config:i}=t;const[o,l]=a.useState(null),{frequency:s,measure:d,strategy:u}=i,h=a.useRef(e),f=w(),v=Ue(f),g=a.useCallback(function(D){D===void 0&&(D=[]),!v.current&&l(y=>y===null?D:y.concat(D.filter(S=>!y.includes(S))))},[v]),N=a.useRef(null),x=Ve(D=>{if(f&&!n)return Jt;if(!D||D===Jt||h.current!==e||o!=null){const y=new Map;for(let S of e){if(!S)continue;if(o&&o.length>0&&!o.includes(S.id)&&S.rect.current){y.set(S.id,S.rect.current);continue}const R=S.node.current,k=R?new Nt(d(R),R):null;S.rect.current=k,k&&y.set(S.id,k)}return y}return D},[e,o,n,f,d]);return a.useEffect(()=>{h.current=e},[e]),a.useEffect(()=>{f||g()},[n,f]),a.useEffect(()=>{o&&o.length>0&&l(null)},[JSON.stringify(o)]),a.useEffect(()=>{f||typeof s!="number"||N.current!==null||(N.current=setTimeout(()=>{g(),N.current=null},s))},[s,f,g,...r]),{droppableRects:x,measureDroppableContainers:g,measuringScheduled:o!=null};function w(){switch(u){case He.Always:return!1;case He.BeforeDragging:return n;default:return!n}}}function yn(e,t){return Ve(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function oi(e,t){return yn(e,t)}function si(e){let{callback:t,disabled:n}=e;const r=Dt(t),i=a.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(r)},[r,n]);return a.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function it(e){let{callback:t,disabled:n}=e;const r=Dt(t),i=a.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(r)},[n]);return a.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function ai(e){return new Nt(Ae(e),e)}function Qt(e,t,n){t===void 0&&(t=ai);const[r,i]=a.useState(null);function o(){i(d=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=d??n)!=null?u:null}const h=t(e);return JSON.stringify(d)===JSON.stringify(h)?d:h})}const l=si({callback(d){if(e)for(const u of d){const{type:h,target:f}=u;if(h==="childList"&&f instanceof HTMLElement&&f.contains(e)){o();break}}}}),s=it({callback:o});return ce(()=>{o(),e?(s==null||s.observe(e),l==null||l.observe(document.body,{childList:!0,subtree:!0})):(s==null||s.disconnect(),l==null||l.disconnect())},[e]),r}function li(e){const t=yn(e);return fn(e,t)}const Zt=[];function ci(e){const t=a.useRef(e),n=Ve(r=>e?r&&r!==Zt&&e&&t.current&&e.parentNode===t.current.parentNode?r:rt(e):Zt,[e]);return a.useEffect(()=>{t.current=e},[e]),n}function di(e){const[t,n]=a.useState(null),r=a.useRef(e),i=a.useCallback(o=>{const l=ht(o.target);l&&n(s=>s?(s.set(l,xt(l)),new Map(s)):null)},[]);return a.useEffect(()=>{const o=r.current;if(e!==o){l(o);const s=e.map(d=>{const u=ht(d);return u?(u.addEventListener("scroll",i,{passive:!0}),[u,xt(u)]):null}).filter(d=>d!=null);n(s.length?new Map(s):null),r.current=e}return()=>{l(e),l(o)};function l(s){s.forEach(d=>{const u=ht(d);u==null||u.removeEventListener("scroll",i)})}},[i,e]),a.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,l)=>je(o,l),se):xn(e):se,[e,t])}function en(e,t){t===void 0&&(t=[]);const n=a.useRef(null);return a.useEffect(()=>{n.current=null},t),a.useEffect(()=>{const r=e!==se;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?Fe(e,n.current):se}function ui(e){a.useEffect(()=>{if(!nt)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function fi(e,t){return a.useMemo(()=>e.reduce((n,r)=>{let{eventName:i,handler:o}=r;return n[i]=l=>{o(l,t)},n},{}),[e,t])}function wn(e){return a.useMemo(()=>e?Lr(e):null,[e])}const tn=[];function hi(e,t){t===void 0&&(t=Ae);const[n]=e,r=wn(n?q(n):null),[i,o]=a.useState(tn);function l(){o(()=>e.length?e.map(d=>vn(d)?r:new Nt(t(d),d)):tn)}const s=it({callback:l});return ce(()=>{s==null||s.disconnect(),l(),e.forEach(d=>s==null?void 0:s.observe(d))},[e]),i}function gi(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Xe(t)?t:e}function pi(e){let{measure:t}=e;const[n,r]=a.useState(null),i=a.useCallback(u=>{for(const{target:h}of u)if(Xe(h)){r(f=>{const v=t(h);return f?{...f,width:v.width,height:v.height}:v});break}},[t]),o=it({callback:i}),l=a.useCallback(u=>{const h=gi(u);o==null||o.disconnect(),h&&(o==null||o.observe(h)),r(h?t(h):null)},[t,o]),[s,d]=Qe(l);return a.useMemo(()=>({nodeRef:s,rect:n,setRef:d}),[n,s,d])}const vi=[{sensor:Et,options:{}},{sensor:kt,options:{}}],bi={current:{}},Je={draggable:{measure:Wt},droppable:{measure:Wt,strategy:He.WhileDragging,frequency:yt.Optimized},dragOverlay:{measure:Ae}};class Be extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const xi={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Be,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ze},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Je,measureDroppableContainers:Ze,windowRect:null,measuringScheduled:!1},mi={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ze,draggableNodes:new Map,over:null,measureDroppableContainers:Ze},ot=a.createContext(mi),Sn=a.createContext(xi);function yi(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Be}}}function wi(e,t){switch(t.type){case P.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case P.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case P.DragEnd:case P.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case P.RegisterDroppable:{const{element:n}=t,{id:r}=n,i=new Be(e.droppable.containers);return i.set(r,n),{...e,droppable:{...e.droppable,containers:i}}}case P.SetDroppableDisabled:{const{id:n,key:r,disabled:i}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const l=new Be(e.droppable.containers);return l.set(n,{...o,disabled:i}),{...e,droppable:{...e.droppable,containers:l}}}case P.UnregisterDroppable:{const{id:n,key:r}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const o=new Be(e.droppable.containers);return o.delete(n),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function Si(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:i}=a.useContext(ot),o=vt(r),l=vt(n==null?void 0:n.id);return a.useEffect(()=>{if(!t&&!r&&o&&l!=null){if(!Rt(o)||document.activeElement===o.target)return;const s=i.get(l);if(!s)return;const{activatorNode:d,node:u}=s;if(!d.current&&!u.current)return;requestAnimationFrame(()=>{for(const h of[d.current,u.current]){if(!h)continue;const f=gr(h);if(f){f.focus();break}}})}},[r,t,i,l,o]),null}function Ci(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((i,o)=>o({transform:i,...r}),n):n}function Di(e){return a.useMemo(()=>({draggable:{...Je.draggable,...e==null?void 0:e.draggable},droppable:{...Je.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Je.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function Ri(e){let{activeNode:t,measure:n,initialRect:r,config:i=!0}=e;const o=a.useRef(!1),{x:l,y:s}=typeof i=="boolean"?{x:i,y:i}:i;ce(()=>{if(!l&&!s||!t){o.current=!1;return}if(o.current||!r)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const h=n(u),f=fn(h,r);if(l||(f.x=0),s||(f.y=0),o.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const v=hn(u);v&&v.scrollBy({top:f.y,left:f.x})}},[t,l,s,r,n])}const Cn=a.createContext({...se,scaleX:1,scaleY:1});var xe;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(xe||(xe={}));const Ni=a.memo(function(t){var n,r,i,o;let{id:l,accessibility:s,autoScroll:d=!0,children:u,sensors:h=vi,collisionDetection:f=Er,measuring:v,modifiers:g,...N}=t;const x=a.useReducer(wi,void 0,yi),[w,D]=x,[y,S]=yr(),[R,k]=a.useState(xe.Uninitialized),A=R===xe.Initialized,{draggable:{active:p,nodes:b,translate:C},droppable:{containers:j}}=w,I=p!=null?b.get(p):null,V=a.useRef({initial:null,translated:null}),Y=a.useMemo(()=>{var _;return p!=null?{id:p,data:(_=I==null?void 0:I.data)!=null?_:bi,rect:V}:null},[p,I]),K=a.useRef(null),[ue,ye]=a.useState(null),[X,we]=a.useState(null),re=Ue(N,Object.values(N)),me=Ye("DndDescribedBy",l),Se=a.useMemo(()=>j.getEnabled(),[j]),U=Di(v),{droppableRects:ie,measureDroppableContainers:m,measuringScheduled:O}=ii(Se,{dragging:A,dependencies:[C.x,C.y],config:U.droppable}),T=ni(b,p),oe=a.useMemo(()=>X?bt(X):null,[X]),L=Ln(),z=oi(T,U.draggable.measure);Ri({activeNode:p!=null?b.get(p):null,config:L.layoutShiftCompensation,initialRect:z,measure:U.draggable.measure});const E=Qt(T,U.draggable.measure,z),W=Qt(T?T.parentElement:null),F=a.useRef({activatorEvent:null,active:null,activeNode:T,collisionRect:null,collisions:null,droppableRects:ie,draggableNodes:b,draggingNode:null,draggingNodeRect:null,droppableContainers:j,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),fe=j.getNodeFor((n=F.current.over)==null?void 0:n.id),J=pi({measure:U.dragOverlay.measure}),Ce=(r=J.nodeRef.current)!=null?r:T,De=A?(i=J.rect)!=null?i:E:null,At=!!(J.nodeRef.current&&J.rect),Tt=li(At?null:E),st=wn(Ce?q(Ce):null),he=ci(A?fe??T:null),We=hi(he),Ge=Ci(g,{transform:{x:C.x-Tt.x,y:C.y-Tt.y,scaleX:1,scaleY:1},activatorEvent:X,active:Y,activeNodeRect:E,containerNodeRect:W,draggingNodeRect:De,over:F.current.over,overlayNodeRect:J.rect,scrollableAncestors:he,scrollableAncestorRects:We,windowRect:st}),It=oe?je(oe,C):null,Ot=di(he),En=en(Ot),Mn=en(Ot,[E]),Re=je(Ge,En),Ne=De?Tr(De,Ge):null,Te=Y&&Ne?f({active:Y,collisionRect:Ne,droppableRects:ie,droppableContainers:Se,pointerCoordinates:It}):null,zt=un(Te,"id"),[ge,Lt]=a.useState(null),An=At?Ge:je(Ge,Mn),Tn=Mr(An,(o=ge==null?void 0:ge.rect)!=null?o:null,E),at=a.useRef(null),Pt=a.useCallback((_,Q)=>{let{sensor:Z,options:pe}=Q;if(K.current==null)return;const te=b.get(K.current);if(!te)return;const ee=_.nativeEvent,ae=new Z({active:K.current,activeNode:te,event:ee,options:pe,context:F,onAbort(B){if(!b.get(B))return;const{onDragAbort:le}=re.current,de={id:B};le==null||le(de),y({type:"onDragAbort",event:de})},onPending(B,ve,le,de){if(!b.get(B))return;const{onDragPending:Oe}=re.current,be={id:B,constraint:ve,initialCoordinates:le,offset:de};Oe==null||Oe(be),y({type:"onDragPending",event:be})},onStart(B){const ve=K.current;if(ve==null)return;const le=b.get(ve);if(!le)return;const{onDragStart:de}=re.current,Ie={activatorEvent:ee,active:{id:ve,data:le.data,rect:V}};Le.unstable_batchedUpdates(()=>{de==null||de(Ie),k(xe.Initializing),D({type:P.DragStart,initialCoordinates:B,active:ve}),y({type:"onDragStart",event:Ie}),ye(at.current),we(ee)})},onMove(B){D({type:P.DragMove,coordinates:B})},onEnd:ke(P.DragEnd),onCancel:ke(P.DragCancel)});at.current=ae;function ke(B){return async function(){const{active:le,collisions:de,over:Ie,scrollAdjustedTranslate:Oe}=F.current;let be=null;if(le&&Oe){const{cancelDrop:ze}=re.current;be={activatorEvent:ee,active:le,collisions:de,delta:Oe,over:Ie},B===P.DragEnd&&typeof ze=="function"&&await Promise.resolve(ze(be))&&(B=P.DragCancel)}K.current=null,Le.unstable_batchedUpdates(()=>{D({type:B}),k(xe.Uninitialized),Lt(null),ye(null),we(null),at.current=null;const ze=B===P.DragEnd?"onDragEnd":"onDragCancel";if(be){const lt=re.current[ze];lt==null||lt(be),y({type:ze,event:be})}})}}},[b]),In=a.useCallback((_,Q)=>(Z,pe)=>{const te=Z.nativeEvent,ee=b.get(pe);if(K.current!==null||!ee||te.dndKit||te.defaultPrevented)return;const ae={active:ee};_(Z,Q.options,ae)===!0&&(te.dndKit={capturedBy:Q.sensor},K.current=pe,Pt(Z,Q))},[b,Pt]),$t=ri(h,In);ui(h),ce(()=>{E&&R===xe.Initializing&&k(xe.Initialized)},[E,R]),a.useEffect(()=>{const{onDragMove:_}=re.current,{active:Q,activatorEvent:Z,collisions:pe,over:te}=F.current;if(!Q||!Z)return;const ee={active:Q,activatorEvent:Z,collisions:pe,delta:{x:Re.x,y:Re.y},over:te};Le.unstable_batchedUpdates(()=>{_==null||_(ee),y({type:"onDragMove",event:ee})})},[Re.x,Re.y]),a.useEffect(()=>{const{active:_,activatorEvent:Q,collisions:Z,droppableContainers:pe,scrollAdjustedTranslate:te}=F.current;if(!_||K.current==null||!Q||!te)return;const{onDragOver:ee}=re.current,ae=pe.get(zt),ke=ae&&ae.rect.current?{id:ae.id,rect:ae.rect.current,data:ae.data,disabled:ae.disabled}:null,B={active:_,activatorEvent:Q,collisions:Z,delta:{x:te.x,y:te.y},over:ke};Le.unstable_batchedUpdates(()=>{Lt(ke),ee==null||ee(B),y({type:"onDragOver",event:B})})},[zt]),ce(()=>{F.current={activatorEvent:X,active:Y,activeNode:T,collisionRect:Ne,collisions:Te,droppableRects:ie,draggableNodes:b,draggingNode:Ce,draggingNodeRect:De,droppableContainers:j,over:ge,scrollableAncestors:he,scrollAdjustedTranslate:Re},V.current={initial:De,translated:Ne}},[Y,T,Te,Ne,b,Ce,De,ie,j,ge,he,Re]),Zr({...L,delta:C,draggingRect:Ne,pointerCoordinates:It,scrollableAncestors:he,scrollableAncestorRects:We});const On=a.useMemo(()=>({active:Y,activeNode:T,activeNodeRect:E,activatorEvent:X,collisions:Te,containerNodeRect:W,dragOverlay:J,draggableNodes:b,droppableContainers:j,droppableRects:ie,over:ge,measureDroppableContainers:m,scrollableAncestors:he,scrollableAncestorRects:We,measuringConfiguration:U,measuringScheduled:O,windowRect:st}),[Y,T,E,X,Te,W,J,b,j,ie,ge,m,he,We,U,O,st]),zn=a.useMemo(()=>({activatorEvent:X,activators:$t,active:Y,activeNodeRect:E,ariaDescribedById:{draggable:me},dispatch:D,draggableNodes:b,over:ge,measureDroppableContainers:m}),[X,$t,Y,E,D,me,b,ge,m]);return G.createElement(ln.Provider,{value:S},G.createElement(ot.Provider,{value:zn},G.createElement(Sn.Provider,{value:On},G.createElement(Cn.Provider,{value:Tn},u)),G.createElement(Si,{disabled:(s==null?void 0:s.restoreFocus)===!1})),G.createElement(Cr,{...s,hiddenTextDescribedById:me}));function Ln(){const _=(ue==null?void 0:ue.autoScrollEnabled)===!1,Q=typeof d=="object"?d.enabled===!1:d===!1,Z=A&&!_&&!Q;return typeof d=="object"?{...d,enabled:Z}:{enabled:Z}}}),ki=a.createContext(null),nn="button",ji="Draggable";function Ei(e){let{id:t,data:n,disabled:r=!1,attributes:i}=e;const o=Ye(ji),{activators:l,activatorEvent:s,active:d,activeNodeRect:u,ariaDescribedById:h,draggableNodes:f,over:v}=a.useContext(ot),{role:g=nn,roleDescription:N="draggable",tabIndex:x=0}=i??{},w=(d==null?void 0:d.id)===t,D=a.useContext(w?Cn:ki),[y,S]=Qe(),[R,k]=Qe(),A=fi(l,t),p=Ue(n);ce(()=>(f.set(t,{id:t,key:o,node:y,activatorNode:R,data:p}),()=>{const C=f.get(t);C&&C.key===o&&f.delete(t)}),[f,t]);const b=a.useMemo(()=>({role:g,tabIndex:x,"aria-disabled":r,"aria-pressed":w&&g===nn?!0:void 0,"aria-roledescription":N,"aria-describedby":h.draggable}),[r,g,x,w,N,h.draggable]);return{active:d,activatorEvent:s,activeNodeRect:u,attributes:b,isDragging:w,listeners:r?void 0:A,node:y,over:v,setNodeRef:S,setActivatorNodeRef:k,transform:D}}function Mi(){return a.useContext(Sn)}const Ai="Droppable",Ti={timeout:25};function Ii(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:i}=e;const o=Ye(Ai),{active:l,dispatch:s,over:d,measureDroppableContainers:u}=a.useContext(ot),h=a.useRef({disabled:n}),f=a.useRef(!1),v=a.useRef(null),g=a.useRef(null),{disabled:N,updateMeasurementsFor:x,timeout:w}={...Ti,...i},D=Ue(x??r),y=a.useCallback(()=>{if(!f.current){f.current=!0;return}g.current!=null&&clearTimeout(g.current),g.current=setTimeout(()=>{u(Array.isArray(D.current)?D.current:[D.current]),g.current=null},w)},[w]),S=it({callback:y,disabled:N||!l}),R=a.useCallback((b,C)=>{S&&(C&&(S.unobserve(C),f.current=!1),b&&S.observe(b))},[S]),[k,A]=Qe(R),p=Ue(t);return a.useEffect(()=>{!S||!k.current||(S.disconnect(),f.current=!1,S.observe(k.current))},[k,S]),a.useEffect(()=>(s({type:P.RegisterDroppable,element:{id:r,key:o,disabled:n,node:k,rect:v,data:p}}),()=>s({type:P.UnregisterDroppable,key:o,id:r})),[r]),a.useEffect(()=>{n!==h.current.disabled&&(s({type:P.SetDroppableDisabled,id:r,key:o,disabled:n}),h.current.disabled=n)},[r,o,n,s]),{active:l,rect:v,isOver:(d==null?void 0:d.id)===r,node:k,over:d,setNodeRef:A}}function Mt(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function Oi(e,t){return e.reduce((n,r,i)=>{const o=t.get(r);return o&&(n[i]=o),n},Array(e.length))}function qe(e){return e!==null&&e>=0}function zi(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Li(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Dn=e=>{let{rects:t,activeIndex:n,overIndex:r,index:i}=e;const o=Mt(t,r,n),l=t[i],s=o[i];return!s||!l?null:{x:s.left-l.left,y:s.top-l.top,scaleX:s.width/l.width,scaleY:s.height/l.height}},Ke={scaleX:1,scaleY:1},Pi=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:i,rects:o,overIndex:l}=e;const s=(t=o[n])!=null?t:r;if(!s)return null;if(i===n){const u=o[l];return u?{x:0,y:n<l?u.top+u.height-(s.top+s.height):u.top-s.top,...Ke}:null}const d=$i(o,i,n);return i>n&&i<=l?{x:0,y:-s.height-d,...Ke}:i<n&&i>=l?{x:0,y:s.height+d,...Ke}:{x:0,y:0,...Ke}};function $i(e,t,n){const r=e[t],i=e[t-1],o=e[t+1];return r?n<t?i?r.top-(i.top+i.height):o?o.top-(r.top+r.height):0:o?o.top-(r.top+r.height):i?r.top-(i.top+i.height):0:0}const Rn="Sortable",Nn=G.createContext({activeIndex:-1,containerId:Rn,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Dn,disabled:{draggable:!1,droppable:!1}});function Bi(e){let{children:t,id:n,items:r,strategy:i=Dn,disabled:o=!1}=e;const{active:l,dragOverlay:s,droppableRects:d,over:u,measureDroppableContainers:h}=Mi(),f=Ye(Rn,n),v=s.rect!==null,g=a.useMemo(()=>r.map(A=>typeof A=="object"&&"id"in A?A.id:A),[r]),N=l!=null,x=l?g.indexOf(l.id):-1,w=u?g.indexOf(u.id):-1,D=a.useRef(g),y=!zi(g,D.current),S=w!==-1&&x===-1||y,R=Li(o);ce(()=>{y&&N&&h(g)},[y,g,N,h]),a.useEffect(()=>{D.current=g},[g]);const k=a.useMemo(()=>({activeIndex:x,containerId:f,disabled:R,disableTransforms:S,items:g,overIndex:w,useDragOverlay:v,sortedRects:Oi(g,d),strategy:i}),[x,f,R.draggable,R.droppable,S,g,w,d,v,i]);return G.createElement(Nn.Provider,{value:k},t)}const Ui=e=>{let{id:t,items:n,activeIndex:r,overIndex:i}=e;return Mt(n,r,i).indexOf(t)},Fi=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:i,items:o,newIndex:l,previousItems:s,previousContainerId:d,transition:u}=e;return!u||!r||s!==o&&i===l?!1:n?!0:l!==i&&t===d},_i={duration:200,easing:"ease"},kn="transform",Hi=_e.Transition.toString({property:kn,duration:0,easing:"linear"}),Xi={roleDescription:"sortable"};function Vi(e){let{disabled:t,index:n,node:r,rect:i}=e;const[o,l]=a.useState(null),s=a.useRef(n);return ce(()=>{if(!t&&n!==s.current&&r.current){const d=i.current;if(d){const u=Ae(r.current,{ignoreTransform:!0}),h={x:d.left-u.left,y:d.top-u.top,scaleX:d.width/u.width,scaleY:d.height/u.height};(h.x||h.y)&&l(h)}}n!==s.current&&(s.current=n)},[t,n,r,i]),a.useEffect(()=>{o&&l(null)},[o]),o}function Yi(e){let{animateLayoutChanges:t=Fi,attributes:n,disabled:r,data:i,getNewIndex:o=Ui,id:l,strategy:s,resizeObserverConfig:d,transition:u=_i}=e;const{items:h,containerId:f,activeIndex:v,disabled:g,disableTransforms:N,sortedRects:x,overIndex:w,useDragOverlay:D,strategy:y}=a.useContext(Nn),S=Wi(r,g),R=h.indexOf(l),k=a.useMemo(()=>({sortable:{containerId:f,index:R,items:h},...i}),[f,i,R,h]),A=a.useMemo(()=>h.slice(h.indexOf(l)),[h,l]),{rect:p,node:b,isOver:C,setNodeRef:j}=Ii({id:l,data:k,disabled:S.droppable,resizeObserverConfig:{updateMeasurementsFor:A,...d}}),{active:I,activatorEvent:V,activeNodeRect:Y,attributes:K,setNodeRef:ue,listeners:ye,isDragging:X,over:we,setActivatorNodeRef:re,transform:me}=Ei({id:l,data:k,attributes:{...Xi,...n},disabled:S.draggable}),Se=dr(j,ue),U=!!I,ie=U&&!N&&qe(v)&&qe(w),m=!D&&X,O=m&&ie?me:null,oe=ie?O??(s??y)({rects:x,activeNodeRect:Y,activeIndex:v,overIndex:w,index:R}):null,L=qe(v)&&qe(w)?o({id:l,items:h,activeIndex:v,overIndex:w}):R,z=I==null?void 0:I.id,E=a.useRef({activeId:z,items:h,newIndex:L,containerId:f}),W=h!==E.current.items,F=t({active:I,containerId:f,isDragging:X,isSorting:U,id:l,index:R,items:h,newIndex:E.current.newIndex,previousItems:E.current.items,previousContainerId:E.current.containerId,transition:u,wasDragging:E.current.activeId!=null}),fe=Vi({disabled:!F,index:R,node:b,rect:p});return a.useEffect(()=>{U&&E.current.newIndex!==L&&(E.current.newIndex=L),f!==E.current.containerId&&(E.current.containerId=f),h!==E.current.items&&(E.current.items=h)},[U,L,f,h]),a.useEffect(()=>{if(z===E.current.activeId)return;if(z!=null&&E.current.activeId==null){E.current.activeId=z;return}const Ce=setTimeout(()=>{E.current.activeId=z},50);return()=>clearTimeout(Ce)},[z]),{active:I,activeIndex:v,attributes:K,data:k,rect:p,index:R,newIndex:L,items:h,isOver:C,isSorting:U,isDragging:X,listeners:ye,node:b,overIndex:w,over:we,setNodeRef:Se,setActivatorNodeRef:re,setDroppableNodeRef:j,setDraggableNodeRef:ue,transform:fe??oe,transition:J()};function J(){if(fe||W&&E.current.newIndex===R)return Hi;if(!(m&&!Rt(V)||!u)&&(U||F))return _e.Transition.toString({...u,property:kn})}}function Wi(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function tt(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Gi=[M.Down,M.Right,M.Up,M.Left],qi=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:i,droppableContainers:o,over:l,scrollableAncestors:s}}=t;if(Gi.includes(e.code)){if(e.preventDefault(),!n||!r)return;const d=[];o.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const v=i.get(f.id);if(v)switch(e.code){case M.Down:r.top<v.top&&d.push(f);break;case M.Up:r.top>v.top&&d.push(f);break;case M.Left:r.left>v.left&&d.push(f);break;case M.Right:r.left<v.left&&d.push(f);break}});const u=kr({collisionRect:r,droppableRects:i,droppableContainers:d});let h=un(u,"id");if(h===(l==null?void 0:l.id)&&u.length>1&&(h=u[1].id),h!=null){const f=o.get(n.id),v=o.get(h),g=v?i.get(v.id):null,N=v==null?void 0:v.node.current;if(N&&g&&f&&v){const w=rt(N).some((A,p)=>s[p]!==A),D=jn(f,v),y=Ki(f,v),S=w||!D?{x:0,y:0}:{x:y?r.width-g.width:0,y:y?r.height-g.height:0},R={x:g.left,y:g.top};return S.x&&S.y?R:Fe(R,S)}}}};function jn(e,t){return!tt(e)||!tt(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Ki(e,t){return!tt(e)||!tt(t)||!jn(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}function Ji({id:e,children:t,editMode:n}){const{attributes:r,listeners:i,setNodeRef:o,transform:l,transition:s,isDragging:d}=Yi({id:e}),u={transform:_e.Transform.toString(l),transition:s,zIndex:d?50:"auto",opacity:d?.3:1};return c.jsxs("div",{ref:o,style:u,className:"relative",children:[n&&c.jsx("div",{...r,...i,className:"absolute left-[-40px] top-6 p-2 cursor-grab active:cursor-grabbing text-gray-500 hover:text-white transition-colors touch-none",title:"Trascina per riordinare",children:c.jsx(Qn,{size:24})}),t]})}const Qi=({onFormat:e,onUndo:t,visible:n,canUndo:r})=>{const[i,o]=a.useState(!1),l=[{name:"Verde",value:"#00ff85"},{name:"Rosso",value:"#ff4444"},{name:"Azzurro",value:"#00d4ff"},{name:"Rosa",value:"#ff2882"},{name:"Viola",value:"#a855f7"},{name:"Giallo",value:"#fbbf24"},{name:"Bianco",value:"#ffffff"},{name:"Grigio",value:"#9ca3af"}];return n?c.jsxs("div",{className:"fixed right-4 top-1/2 -translate-y-1/2 bg-pl-dark/95 backdrop-blur-lg border border-white/20 rounded-xl shadow-2xl p-4 z-40 w-64",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h3",{className:"text-white font-bold text-sm",children:"Formatta Testo"}),c.jsx("button",{onMouseDown:s=>{s.preventDefault(),t()},disabled:!r,className:`p-2 rounded-lg transition ${r?"bg-yellow-500/20 hover:bg-yellow-500/30 text-yellow-400":"bg-white/5 text-gray-500 cursor-not-allowed"}`,title:"Annulla (Undo)",children:c.jsx(rr,{size:16})})]}),c.jsxs("div",{className:"mb-3",children:[c.jsx("p",{className:"text-gray-400 text-xs mb-2",children:"Stile"}),c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsx("button",{onMouseDown:s=>{s.preventDefault(),e("strong")},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition",title:"Grassetto",children:c.jsx(qn,{size:18})}),c.jsx("button",{onMouseDown:s=>{s.preventDefault(),e("em")},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition",title:"Corsivo",children:c.jsx(Zn,{size:18})}),c.jsx("button",{onMouseDown:s=>{s.preventDefault(),e("u")},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition",title:"Sottolineato",children:c.jsx(nr,{size:18})})]})]}),c.jsxs("div",{className:"mb-3",children:[c.jsx("p",{className:"text-gray-400 text-xs mb-2",children:"Dimensione"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsxs("button",{onMouseDown:s=>{s.preventDefault(),e("font-size-increase")},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition flex items-center justify-center gap-1",title:"Aumenta",children:[c.jsx(on,{size:16}),c.jsx(Ut,{size:16})]}),c.jsxs("button",{onMouseDown:s=>{s.preventDefault(),e("font-size-decrease")},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition flex items-center justify-center gap-1",title:"Diminuisci",children:[c.jsx(Un,{size:16}),c.jsx(Ut,{size:16})]})]})]}),c.jsxs("div",{className:"mb-3",children:[c.jsx("p",{className:"text-gray-400 text-xs mb-2",children:"Allineamento"}),c.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[c.jsx("button",{onMouseDown:s=>{s.preventDefault(),e("align-left")},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition",title:"Sinistra",children:c.jsx(Vn,{size:16})}),c.jsx("button",{onMouseDown:s=>{s.preventDefault(),e("align-center")},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition",title:"Centro",children:c.jsx(Hn,{size:16})}),c.jsx("button",{onMouseDown:s=>{s.preventDefault(),e("align-right")},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition",title:"Destra",children:c.jsx(Yn,{size:16})}),c.jsx("button",{onMouseDown:s=>{s.preventDefault(),e("align-justify")},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition",title:"Giustificato",children:c.jsx(Xn,{size:16})})]})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("p",{className:"text-gray-400 text-xs",children:"Colore"}),c.jsx("button",{onMouseDown:s=>{s.preventDefault(),o(!i)},className:"p-1 bg-white/10 hover:bg-white/20 rounded text-white transition",children:c.jsx(er,{size:16})})]}),i&&c.jsx("div",{className:"grid grid-cols-4 gap-2",children:l.map(s=>c.jsx("button",{onMouseDown:d=>{d.preventDefault(),e("color",s.value),o(!1)},className:"w-8 h-8 rounded-lg border-2 border-white/20 hover:border-white/50 transition",style:{backgroundColor:s.value},title:s.name},s.value))})]}),c.jsx("div",{className:"mt-3 pt-3 border-t border-white/10",children:c.jsx("p",{className:"text-gray-400 text-xs",children:"Seleziona testo nella textarea per formattare"})})]}):null};function no(){const{user:e,hasRole:t}=wt(),{loading:n,saving:r,cenniPrincipali:i,sections:o,archivedRules:l,undoHistory:s,setCenniPrincipali:d,setSections:u,loadRules:h,saveRules:f,updateSection:v,addSection:g,removeSection:N,addToUndoHistory:x,undo:w,clearUndoHistory:D}=or(),[y,S]=a.useState(!1),[R,k]=a.useState(null),[A,p]=a.useState(!1),[b,C]=a.useState(!1),[j,I]=a.useState(null),[V,Y]=a.useState(null),K=a.useRef(null),ue=a.useRef({}),ye=Dr(Xt(Et),Xt(kt,{coordinateGetter:qi})),X=m=>{const{active:O,over:T}=m;O.id!==(T==null?void 0:T.id)&&T&&u(oe=>{const L=oe.findIndex(E=>E.id===O.id),z=oe.findIndex(E=>E.id===T.id);return Mt(oe,L,z)})};a.useEffect(()=>{if(!y||!t("admin")){C(!1);return}const m=O=>{const T=O.target;T.tagName==="TEXTAREA"&&T.selectionStart!==T.selectionEnd?(I(T),Y({start:T.selectionStart,end:T.selectionEnd}),C(!0)):setTimeout(()=>{T.tagName==="TEXTAREA"&&T.selectionStart===T.selectionEnd&&(C(!1),Y(null))},100)};return document.addEventListener("selectionchange",m),document.addEventListener("mouseup",m),()=>{document.removeEventListener("selectionchange",m),document.removeEventListener("mouseup",m)}},[y,t]);const we=(m,O)=>{if(!j||!V)return;const{start:T,end:oe}=V,L=j.value.substring(T,oe);if(!L)return;let z="";switch(m){case"strong":z=`<strong>${L}</strong>`;break;case"em":z=`<em>${L}</em>`;break;case"u":z=`<u>${L}</u>`;break;case"font-size-increase":z=`<span style="font-size: 1.2em;">${L}</span>`;break;case"font-size-decrease":z=`<span style="font-size: 0.9em;">${L}</span>`;break;case"color":z=`<span style="color: ${O};">${L}</span>`;break;case"align-left":z=`<div style="text-align: left;">${L}</div>`;break;case"align-center":z=`<div style="text-align: center;">${L}</div>`;break;case"align-right":z=`<div style="text-align: right;">${L}</div>`;break;case"align-justify":z=`<div style="text-align: justify;">${L}</div>`;break;default:return}const E=j.value.substring(0,T)+z+j.value.substring(oe),W=j.getAttribute("data-field");if(W&&x(W,j.value),W==="mainText")d(F=>({...F,mainText:E}));else if(W==="partecipanti")d(F=>({...F,partecipanti:E}));else if(W!=null&&W.startsWith("section-")){const F=parseInt(W.replace("section-",""));u(fe=>fe.map(J=>J.id===F?{...J,content:E}:J))}setTimeout(()=>{j&&(j.focus(),j.setSelectionRange(T+z.length,T+z.length))},50)},re=()=>{w(),C(!0)},me=async()=>{await f()?(alert("Regolamento salvato con successo!"),S(!1),D()):alert("Errore durante il salvataggio.")},Se=m=>{k(m),p(!0),setTimeout(()=>{var O;(O=ue.current[m])==null||O.scrollIntoView({behavior:"smooth",block:"start"})},100)},U=()=>{k(null),setTimeout(()=>{var m;(m=K.current)==null||m.scrollIntoView({behavior:"smooth",block:"start"})},100)},ie=m=>{R===m?(k(null),p(!1)):(k(m),p(!1))};return n?c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pl-dark via-pl-dark to-pl-purple flex items-center justify-center",children:c.jsx("div",{className:"text-white text-xl",children:"Caricamento regolamento..."})}):c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pl-dark via-pl-dark to-pl-purple py-8",children:c.jsxs("div",{className:"max-w-5xl mx-auto px-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-8",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Kn,{className:"w-10 h-10 text-pl-pink"}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-4xl font-black text-white",children:"Regolamento PianginaCUP"}),c.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Stagione 2025/26"})]})]}),t("admin")&&c.jsx("div",{className:"flex gap-2",children:y?c.jsx("span",{className:"text-pl-pink text-sm",children:"âœï¸ ModalitÃ  Modifica Attiva"}):c.jsxs("button",{onClick:()=>S(!0),className:"flex items-center gap-2 px-4 py-2 bg-pl-pink/20 hover:bg-pl-pink/30 rounded-lg text-white border border-pl-pink/50 transition",children:[c.jsx(tr,{size:18}),"Modifica"]})})]}),y&&t("admin")&&c.jsxs("div",{className:"fixed bottom-4 left-1/2 -translate-x-1/2 bg-pl-dark/95 backdrop-blur-lg border border-white/20 rounded-xl shadow-2xl px-6 py-3 z-50 flex gap-4",children:[c.jsxs("button",{onClick:me,disabled:r,className:"flex items-center gap-2 px-5 py-2 bg-green-500/20 hover:bg-green-500/30 rounded-lg text-white border border-green-500/50 transition disabled:opacity-50",children:[c.jsx(Bn,{size:18}),r?"Salvataggio...":"Salva Modifiche"]}),c.jsxs("button",{onClick:()=>{S(!1),D(),h()},className:"flex items-center gap-2 px-5 py-2 bg-red-500/20 hover:bg-red-500/30 rounded-lg text-white border border-red-500/50 transition",children:[c.jsx(rn,{size:18}),"Annulla"]})]}),c.jsxs("div",{ref:K,className:"bg-white/10 backdrop-blur-xl rounded-2xl p-6 border border-white/20 mb-8",children:[c.jsx("h2",{className:"text-xl font-bold text-pl-teal mb-4",children:"ðŸ“‘ Indice"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx("div",{className:"text-gray-300 font-medium px-3 py-2 rounded-lg bg-white/5",children:i.title||"1. Cenni Principali e Avvertenze"}),o.map(m=>c.jsx("button",{onClick:()=>Se(m.id),className:"text-left text-gray-300 hover:text-white font-medium px-3 py-2 rounded-lg bg-white/5 hover:bg-white/10 transition",children:m.title},m.id))]})]}),c.jsxs("div",{className:"bg-white/10 backdrop-blur-xl rounded-2xl p-8 border border-white/20 mb-8",children:[c.jsx("div",{className:"text-center mb-8",children:y&&t("admin")?c.jsx("input",{type:"text",value:i.title||"1. Cenni Principali e Avvertenze",onChange:m=>d(O=>({...O,title:m.target.value})),className:"text-3xl font-bold text-pl-teal bg-transparent border-b border-pl-pink/30 focus:outline-none focus:border-pl-pink text-center w-full"}):c.jsx("h2",{className:"text-3xl font-bold text-pl-teal",children:i.title||"1. Cenni Principali e Avvertenze"})}),c.jsx("div",{className:"text-gray-200 leading-relaxed mb-8 space-y-4",children:c.jsx(_t,{value:i.mainText,onChange:m=>d(O=>({...O,mainText:m})),editMode:y,multiline:!0,dataField:"mainText"})})]}),c.jsx(Ni,{sensors:ye,collisionDetection:Nr,onDragEnd:X,children:c.jsx(Bi,{items:o.map(m=>m.id),strategy:Pi,disabled:!y||!t("admin"),children:c.jsxs("div",{className:"space-y-4",children:[y&&t("admin")&&c.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center gap-2 py-3 bg-pl-teal/20 hover:bg-pl-teal/30 rounded-xl text-white border border-pl-teal/50 transition",children:[c.jsx(on,{size:20}),"Aggiungi Sezione"]}),o.map(m=>c.jsx(Ji,{id:m.id,editMode:y&&t("admin"),children:c.jsxs("div",{ref:O=>ue.current[m.id]=O,className:"bg-white/10 backdrop-blur-xl rounded-2xl border border-white/20 overflow-hidden",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 cursor-pointer hover:bg-white/5 transition",onClick:()=>ie(m.id),children:[y&&t("admin")?c.jsx("input",{type:"text",value:m.title,onChange:O=>v(m.id,"title",O.target.value),onClick:O=>O.stopPropagation(),className:"flex-1 text-xl font-bold text-white bg-transparent border-b border-pl-pink/30 focus:outline-none focus:border-pl-pink text-center"}):c.jsx("h3",{className:"flex-1 text-xl font-bold text-white text-center",children:m.title}),c.jsx(Fn,{size:24,className:`text-gray-400 transition-transform ml-4 ${R===m.id?"rotate-180":""}`}),y&&t("admin")&&c.jsx("button",{onClick:O=>{O.stopPropagation(),N(m.id)},className:"ml-2 p-2 bg-red-500/20 hover:bg-red-500/30 rounded-lg text-red-400 border border-red-500/50 transition",children:c.jsx(_n,{size:18})})]}),R===m.id&&c.jsxs("div",{className:"p-6 pt-0 border-t border-white/10",children:[c.jsx("div",{className:"text-gray-200 leading-relaxed space-y-3",children:c.jsx(_t,{value:m.content,onChange:O=>v(m.id,"content",O),editMode:y,multiline:!0,dataField:`section-${m.id}`})}),A&&R===m.id&&c.jsxs("button",{onClick:U,className:"mt-6 flex items-center gap-2 px-4 py-2 bg-pl-teal/20 hover:bg-pl-teal/30 rounded-lg text-white border border-pl-teal/50 transition mx-auto",children:[c.jsx(Gn,{size:18}),"Torna all'Indice"]})]})]})},m.id))]})})}),c.jsx("div",{className:"mt-8 text-center text-gray-500 text-sm italic",children:c.jsx("p",{children:"âš ï¸ SOLTANTO i membri del Comitato Decisionale possono modificare questo documento."})}),c.jsx(cr,{archives:l}),y&&t("admin")&&c.jsx(Qi,{visible:b,onFormat:we,onUndo:re,canUndo:s.length>0})]})})}export{no as Rules};
