import{r as t,u as v,g as N,j as e,A as P,h as l,d as m,D as g,i as x,Q as A}from"./index-ClM_nN6k.js";import{L as C}from"./lock-DkA79cqZ.js";function k(){const[n,h]=t.useState(""),[r,w]=t.useState(""),[i,f]=t.useState(""),[d,o]=t.useState(""),[c,u]=t.useState(!1),{logout:b}=v(),y=N(),j=async s=>{if(s.preventDefault(),o(""),r!==i){o("Le password non coincidono");return}if(r.length<8){o("La password deve essere di almeno 8 caratteri");return}u(!0);try{await l.updatePassword(r,n);const a=await l.get();await l.updatePrefs({...a.prefs,force_pass_reset:!1});const p=await m.listDocuments(g,x,[A.equal("user_id",a.$id)]);p.documents.length>0&&await m.updateDocument(g,x,p.documents[0].$id,{force_pass_reset:!1}),alert("Password aggiornata con successo! Effettua nuovamente l'accesso."),await b(),y("/login")}catch(a){console.error("Password update failed:",a),o(a.message||"Errore durante l'aggiornamento della password")}finally{u(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-pl-dark px-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white/10 backdrop-blur-lg rounded-2xl p-8 shadow-2xl border border-white/20",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(C,{className:"w-16 h-16 text-pl-teal mx-auto mb-4"}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Cambio Password"}),e.jsx("p",{className:"text-gray-300",children:"Ãˆ richiesto un cambio password per sicurezza."})]}),e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"Vecchia Password (Attuale)"}),e.jsx("input",{type:"password",value:n,onChange:s=>h(s.target.value),className:"w-full px-4 py-3 bg-white/5 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-pl-teal",placeholder:"La password che hai appena usato",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"Nuova Password"}),e.jsx("input",{type:"password",value:r,onChange:s=>w(s.target.value),className:"w-full px-4 py-3 bg-white/5 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-pl-teal",placeholder:"Minimo 8 caratteri",required:!0,minLength:8})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"Conferma Password"}),e.jsx("input",{type:"password",value:i,onChange:s=>f(s.target.value),className:"w-full px-4 py-3 bg-white/5 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-pl-teal",placeholder:"Ripeti la password",required:!0})]}),d&&e.jsxs("div",{className:"bg-red-500/20 border border-red-500/50 rounded-lg p-4 flex items-start gap-3 text-red-200 text-sm",children:[e.jsx(P,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{children:d})]}),e.jsx("button",{type:"submit",disabled:c,className:"w-full bg-gradient-to-r from-pl-teal to-pl-green text-pl-dark font-bold py-3 px-6 rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",children:c?"Aggiornamento...":"Aggiorna Password"}),e.jsx("div",{className:"text-center text-xs text-gray-500 mt-4",children:"Non puoi ignorare questo passaggio."})]})]})})}export{k as ForceChangePassword};
